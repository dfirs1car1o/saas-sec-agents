{
  "source": {
    "benchmark_name": "Security Benchmark for Salesforce",
    "benchmark_short_name": "SBS",
    "release_tag": "v0.4.1",
    "xml_url": "https://github.com/Salesforce-Security-Benchmark/docs-site/releases/download/v0.4.1/sbs-controls.xml"
  },
  "catalog": {
    "title": "Security Benchmark for Salesforce",
    "version": "0.4.0",
    "total_controls": 45
  },
  "controls": [
    {
      "control_id": "SBS-ACS-001",
      "category": "Access Controls",
      "category_description": "This section defines controls related to permission sets, permission set groups, profiles, and access governance within Salesforce environments. These controls ensure that organizations maintain a structured, documented, and enforced approach to authorization management, reducing privilege sprawl and unauthorized access risks.",
      "title": "Enforce a Documented Permission Set Model",
      "statement": "All permission sets, permission set groups, and profiles must conform to a documented model maintained in a system of record and enforced continuously.",
      "description": "The organization must define, document, and enforce a standardized permission set model within its system of record. A permission set model defines how the organization structures permissions\u2014for example, using permission set groups to represent personas or departments, and permission sets to represent specific actions or capabilities. The specific structure is determined by the organization, but all profiles, permission sets, and permission set groups must conform to the documented model. No permission constructs may exist outside the defined model, and compliance must be evaluated and enforced on a near real-time basis.\n\n**Example models:**\n\n- Permission set groups represent job roles (Sales Rep, Service Agent), and individual permission sets represent capabilities (View Reports, Edit Accounts)\n\n- Permission set groups represent departments (Sales, Marketing), and permission sets represent access tiers (Standard, Advanced)\n\n- Permission sets represent business functions with no grouping hierarchy",
      "risk": "Without a documented and enforced permission set model, organizations lose visibility into their authorization structure\u2014accumulating ad hoc permission constructs created for one-time needs that are never reviewed or removed. This results in privilege sprawl, inconsistent access patterns, and inability to audit who has what access and why. Security teams cannot assess authorization posture, detect drift, or investigate access-related incidents when no authoritative model exists to compare against. The lack of continuous enforcement means unauthorized or excessive permissions can persist indefinitely without detection.",
      "risk_level": "High",
      "audit_procedure": "1. Obtain the organization's documented permission set model from the designated system of record.  \n\n2. Enumerate all Profiles, Permission Sets, and Permission Set Groups using Salesforce Setup, Metadata API, or Tooling API.  \n\n3. Compare each enumerated item against the documented model to determine whether:  \n\n   - Its purpose or persona aligns with the model.  \n\n   - Its included permissions conform to the model's structure and boundaries.  \n\n   - Its naming and classification match the documented conventions.  \n\n4. Identify any profiles, permission sets, or permission set groups that do not conform to the model.  \n\n5. Verify that the organization has a process or automation that enforces model compliance in near real time (e.g., continuous scanning, pipelines, or governance workflows).",
      "remediation": "1. Update or deprecate noncompliant profiles, permission sets, and permission set groups to align with the documented permission set model.  \n\n2. Migrate users off legacy or misaligned authorization constructs.  \n\n3. Implement or enhance automated enforcement to ensure continuous alignment with the defined model.  \n\n4. Update the system-of-record documentation as the model changes.",
      "default_value": "Salesforce does not enforce any specific permission set model. Profiles, permission sets, and permission set groups can be created without structure or alignment unless governed by the organization.",
      "remediation_scope": {
        "scope": "mechanism",
        "entity_type": ""
      },
      "task": {
        "title_template": "Define, document, and enforce a standardized permission set model"
      }
    },
    {
      "control_id": "SBS-ACS-002",
      "category": "Access Controls",
      "category_description": "This section defines controls related to permission sets, permission set groups, profiles, and access governance within Salesforce environments. These controls ensure that organizations maintain a structured, documented, and enforced approach to authorization management, reducing privilege sprawl and unauthorized access risks.",
      "title": "Documented Justification for All `API-Enabled` Authorizations",
      "statement": "Every authorization granting the `API Enabled` permission must have documented business or technical justification recorded in a system of record.",
      "description": "All profiles, permission sets, and permission set groups that grant the `API Enabled` permission must be recorded in a designated system of record with a documented business or technical justification for requiring API access. Any authorization lacking documented rationale is noncompliant.",
      "risk": "Without documented justification for API-enabled authorizations, organizations lose visibility into which users and systems can programmatically access Salesforce data at scale. The `API Enabled` permission enables large-scale data extraction, bulk modification, and automated operations\u2014capabilities that create significant exposure when granted without oversight. Undocumented API access paths accumulate over time, preventing security teams from assessing data exfiltration risk, investigating suspicious API activity, or enforcing least privilege across automated access patterns.",
      "risk_level": "High",
      "audit_procedure": "1. Enumerate all profiles, permission sets, and permission set groups that include the `API Enabled` permission using Salesforce Setup, Metadata API, Tooling API, or an automated scanner.  \n\n2. Compare the enumerated list against the organization\u2019s designated system of record for API-enabled authorizations.  \n\n3. Verify that every profile, permission set, and permission set group granting \u201cAPI Enabled\u201d has a corresponding entry in the system of record.  \n\n4. Confirm that each entry includes:  \n\n   - A clear business or technical justification for API access, and  \n\n   - Any applicable exception or approval documentation.  \n\n5. Flag as noncompliant any authorizations lacking documentation or justification.",
      "remediation": "1. Remove the `API Enabled` permission from any profile, permission set, or permission set group that lacks a documented justification and is not required for business operations.  \n\n2. For any authorization that legitimately requires API access, add or update the rationale in the system of record to clearly justify the need.  \n\n3. Reconcile and update the system of record to ensure complete and accurate inventory of all API-enabled authorizations.",
      "default_value": "Salesforce does not require or maintain a system of record for API-enabled authorizations. The `API Enabled` permission is disabled by default for standard profiles but may be granted by administrators.",
      "remediation_scope": {
        "scope": "entity",
        "entity_type": "PermissionSetAssignment"
      },
      "task": {
        "title_template": "Review and justify 'API Enabled' assignment: {{entity.name}}"
      }
    },
    {
      "control_id": "SBS-ACS-003",
      "category": "Access Controls",
      "category_description": "This section defines controls related to permission sets, permission set groups, profiles, and access governance within Salesforce environments. These controls ensure that organizations maintain a structured, documented, and enforced approach to authorization management, reducing privilege sprawl and unauthorized access risks.",
      "title": "Documented Justification for `Approve Uninstalled Connected Apps` Permission",
      "statement": "The `Approve Uninstalled Connected Apps` permission must only be assigned to highly trusted users with documented justification and must not be granted to end-users.",
      "description": "All profiles, permission sets, and permission set groups that grant the `Approve Uninstalled Connected Apps` permission must be recorded in a designated system of record with a documented business or technical justification. This permission should only be assigned to highly trusted users, such as administrators and developers involved in managing or testing connected app integrations. Any authorization lacking documented rationale is noncompliant.",
      "risk": "The `Approve Uninstalled Connected Apps` permission allows users to bypass Connected App usage restrictions and self-authorize any OAuth application without administrator approval. This establishes an uncontrolled security boundary: users with this permission can grant external applications access to Salesforce data without oversight, enabling data exfiltration, unauthorized integrations, and potential account compromise. Unlike other permissions that require additional failures to exploit, this permission directly enables unauthorized third-party access the moment it is misassigned\u2014making it a primary security boundary that must be tightly controlled.",
      "risk_level": "Critical",
      "audit_procedure": "1. Enumerate all profiles, permission sets, and permission set groups that include the `Approve Uninstalled Connected Apps` permission using Salesforce Setup, Metadata API, Tooling API, or an automated scanner.  \n\n2. Compare the enumerated list against the organization's designated system of record for this permission.  \n\n3. Verify that every profile, permission set, and permission set group granting \"Approve Uninstalled Connected Apps\" has a corresponding entry in the system of record.  \n\n4. Confirm that each entry includes:  \n\n   - A clear business or technical justification for requiring this permission,  \n\n   - Identification of the user role or persona (e.g., administrator, developer, integration manager),  \n\n   - Any applicable exception or approval documentation, and  \n\n   - Confirmation that the use case is limited to testing or managing connected app integrations.  \n\n5. Verify that the permission is not assigned to end-user profiles or permission sets intended for general business users.  \n\n6. Flag as noncompliant any authorizations lacking documentation, justification, or assigned to unauthorized user populations.",
      "remediation": "1. Remove the `Approve Uninstalled Connected Apps` permission from any profile, permission set, or permission set group that lacks a documented justification or is assigned to end-users.  \n\n2. For any authorization that legitimately requires this permission (e.g., administrators or developers testing connected apps), add or update the rationale in the system of record to clearly justify the need and identify the specific role or use case.  \n\n3. Ensure that connected apps required for business operations are properly installed and allowlisted rather than relying on this permission for end-user access.  \n\n4. Reconcile and update the system of record to ensure complete and accurate inventory of all assignments of this permission.",
      "default_value": "The `Approve Uninstalled Connected Apps` permission is not granted by default in Salesforce. This permission was introduced in September 2025 as part of Connected App Usage Restrictions changes. Organizations must explicitly assign this permission to users who require it for legitimate testing or integration management purposes.",
      "remediation_scope": {
        "scope": "entity",
        "entity_type": "PermissionSetAssignment"
      },
      "task": {
        "title_template": "Review and justify 'Approve Uninstalled Connected Apps' assignment: {{entity.name}}"
      }
    },
    {
      "control_id": "SBS-ACS-004",
      "category": "Access Controls",
      "category_description": "This section defines controls related to permission sets, permission set groups, profiles, and access governance within Salesforce environments. These controls ensure that organizations maintain a structured, documented, and enforced approach to authorization management, reducing privilege sprawl and unauthorized access risks.",
      "title": "Documented Justification for All Super Admin\u2013Equivalent Users",
      "statement": "All users with simultaneous `View All Data`, `Modify All Data`, and `Manage Users` permissions must be documented in a system of record with clear business or technical justification.",
      "description": "All users who hold *simultaneous* authorization for `View All Data`, `Modify All Data`, and `Manage Users`\u2014collectively constituting Super Admin\u2013level access\u2014must be identified and documented in the system of record with a clear business or technical justification. Any user with this combination of permissions who lacks documented rationale is noncompliant.",
      "risk": "Without documented justification for Super Admin\u2013equivalent users, organizations lose visibility into who possesses unrestricted access to the entire Salesforce environment. These users can read and modify all data, manage user accounts, and alter the security posture of the org without oversight. Undocumented Super Admin access prevents security teams from assessing breach impact, investigating administrative actions, or maintaining accountability for the most sensitive operations. The inability to identify and justify these users also prevents effective access reviews and creates persistent exposure from forgotten or orphaned administrative accounts.",
      "risk_level": "High",
      "audit_procedure": "1. Enumerate all users who simultaneously possess the following permissions through any profile, permission set, or permission set group:  \n\n   - `View All Data`\n\n   - `Modify All Data`  \n\n   - `Manage Users`\n\n2. Compile a list of all users meeting the criteria for Super Admin\u2013equivalent access.  \n\n3. Compare the list against the organization\u2019s system of record.  \n\n4. Verify that each Super Admin\u2013equivalent user has corresponding documentation that includes:  \n\n   - A clear business or technical justification for requiring this level of access, and  \n\n   - Any relevant exception or approval records.  \n\n5. Flag as noncompliant any users with Super Admin\u2013equivalent access lacking documentation or justification.",
      "remediation": "1. Remove one or more of the Super Admin\u2013equivalent permissions from any user who does not have a documented business or technical justification.  \n\n2. For users who legitimately require this level of access, add or update rationale within the system of record.  \n\n3. Reassess user access to ensure alignment with least privilege, reducing broad permissions where narrower privileges are sufficient.",
      "default_value": "Salesforce does not limit the number of users who may receive these permissions, and does not maintain any system of record regarding administrative access.",
      "remediation_scope": {
        "scope": "entity",
        "entity_type": "User"
      },
      "task": {
        "title_template": "Document justification for Super Admin-equivalent user: {{entity.name}}"
      }
    },
    {
      "control_id": "SBS-ACS-005",
      "category": "Access Controls",
      "category_description": "This section defines controls related to permission sets, permission set groups, profiles, and access governance within Salesforce environments. These controls ensure that organizations maintain a structured, documented, and enforced approach to authorization management, reducing privilege sprawl and unauthorized access risks.",
      "title": "Only Use Custom Profiles for Active Users",
      "statement": "All active users must be assigned custom profiles. The out-of-the-box standard profiles must not be used.",
      "description": "Any regular user that can access the org, must use a custom profile. If a user has one of the standard profiles (e.g. \"System Administrator\", \"Standard User\", \"Salesforce - Minimum Access\"), the user is non-compliant. This only affects personal users, not machine users that use the default \"API Only\" permission sets.",
      "risk": "Standard profiles are managed by Salesforce, not the organization\u2014meaning Salesforce can enable permissions and object access on these profiles when features are released or platform updates occur without administrator approval. This creates an uncontrolled change vector: users assigned to standard profiles may gain new capabilities unexpectedly, bypassing the organization's authorization governance. Standard profiles are also overly permissive by default (e.g., \"Standard User\" grants \"View Setup,\" \"System Administrator\" grants developer-level permissions), making it impossible to enforce least privilege. Without custom profiles, organizations cannot investigate authorization changes or maintain accountability for who approved which permissions.",
      "risk_level": "High",
      "audit_procedure": "1. Enumerate all **human** users that are \"Active\" (`IsActive = true` on the user flag)\n\n2. Flag all users noncompliant that use a standard profile (`IsCustom = false` on the profile metadata)",
      "remediation": "1. Setup a custom profile for each standard profile that is used\n\n2. Manage permissions and object access on these profiles to be compliant with the other controls of the SBS\n\n3. Assign the new custom profiles to your active users, following the principle of \"least privilege access\"",
      "default_value": "Salesforce does not require to create and assign custom profiles.",
      "remediation_scope": {
        "scope": "entity",
        "entity_type": "Profile"
      },
      "task": {
        "title_template": "Ensure that {{entity.name}} is not assigned to any users"
      }
    },
    {
      "control_id": "SBS-ACS-006",
      "category": "Access Controls",
      "category_description": "This section defines controls related to permission sets, permission set groups, profiles, and access governance within Salesforce environments. These controls ensure that organizations maintain a structured, documented, and enforced approach to authorization management, reducing privilege sprawl and unauthorized access risks.",
      "title": "Documented Justification for `Use Any API Client` Permission",
      "statement": "The `Use Any API Client` permission, which bypasses default behavior in orgs with \"API Access Control\" enabled, must only be assigned to highly trusted users with documented justification and must not be granted to end-users.",
      "description": "All profiles, permission sets, and permission set groups that grant the `Use Any API Client` permission must be recorded in a designated system of record with a documented business or technical justification. This permission should only be assigned to highly trusted users, such as administrators and developers involved in managing or testing connected app integrations. Any authorization lacking documented rationale is noncompliant.",
      "risk": "The `Use Any API Client` permission allows users to bypass API Access Control entirely, authorizing any OAuth-connected application without requiring it to be pre-vetted or allowlisted. This establishes an uncontrolled security boundary: users with this permission can grant data access to arbitrary external applications, enabling data exfiltration, unauthorized integrations, and potential account compromise without administrator oversight. Granting this permission to unauthorized personnel completely defeats the purpose of API Access Control, creating a direct path to unauthorized third-party access that requires no other control to fail.",
      "risk_level": "Critical",
      "audit_procedure": "1. Enumerate all profiles, permission sets, and permission set groups that include the `Use Any API Client` permission using Salesforce Setup, Metadata API, Tooling API, or an automated scanner.  \n\n2. Compare the enumerated list against the organization's designated system of record for this permission.  \n\n3. Verify that every profile, permission set, and permission set group granting `Use Any API Client` has a corresponding entry in the system of record.  \n\n4. Confirm that each entry includes:  \n\n   - A clear business or technical justification for requiring this permission,  \n\n   - Identification of the user role or persona (e.g., administrator, developer, integration manager),  \n\n   - Any applicable exception or approval documentation, and  \n\n   - Confirmation that the use case is limited to testing or managing connected app integrations.  \n\n5. Verify that the permission is not assigned to end-user profiles or permission sets intended for general business users.  \n\n6. Flag as noncompliant any authorizations lacking documentation, justification, or assigned to unauthorized user populations.",
      "remediation": "1. Remove the `Use Any API Client` permission from any profile, permission set, or permission set group that lacks a documented justification or is assigned to end-users.  \n\n2. For any authorization that legitimately requires this permission (e.g., administrators or developers testing connected apps), add or update the rationale in the system of record to clearly justify the need and identify the specific role or use case.  \n\n3. Ensure that connected apps required for business operations are properly vetted and allowlisted rather than relying on this permission for end-user access.  \n\n4. Reconcile and update the system of record to ensure complete and accurate inventory of all assignments of this permission.",
      "default_value": "The `Use Any API Client` permission is not granted by default in Salesforce. Organizations must explicitly assign this permission to users who require it for legitimate testing or integration management purposes.",
      "remediation_scope": {
        "scope": "inventory",
        "entity_type": ""
      },
      "task": {
        "title_template": "Establish and maintain inventory of 'Use Any API Client' permission assignments with documented justification"
      }
    },
    {
      "control_id": "SBS-ACS-007",
      "category": "Access Controls",
      "category_description": "This section defines controls related to permission sets, permission set groups, profiles, and access governance within Salesforce environments. These controls ensure that organizations maintain a structured, documented, and enforced approach to authorization management, reducing privilege sprawl and unauthorized access risks.",
      "title": "Maintain Inventory of Non-Human Identities",
      "statement": "Organizations must maintain an authoritative inventory of all non-human identities, including integration users, automation users, bot users, and API-only accounts.",
      "description": "Non-human identities operate without direct human oversight and often possess persistent credentials with elevated access. Organizations must maintain a complete and current inventory of all such identities to enable effective governance, access reviews, and incident response. The inventory must include identity type, purpose, owner, creation date, and last activity date.",
      "risk": "Without a comprehensive inventory of non-human identities, organizations cannot detect, investigate, or respond to security incidents involving automated access. Non-human identities are frequently created for integrations or automation projects and then forgotten\u2014accumulating as orphaned accounts with persistent credentials and elevated access. Security teams cannot assess which automated systems access Salesforce data, identify compromised integration credentials, or scope the impact of a vendor breach. This loss of visibility prevents effective governance of automated access and creates persistent security exposure from untracked machine accounts.",
      "risk_level": "High",
      "audit_procedure": "1. Request the organization's inventory of non-human identities\n\n2. Query Salesforce for all users where `IsActive = true` and any of the following conditions apply:\n\n   - Username contains \"integration\", \"api\", \"bot\", \"automation\", or \"service\"\n\n   - Profile name contains \"Integration\", \"API\", or similar indicators\n\n   - User has \"API Only User\" permission enabled\n\n   - User is associated with Einstein Bot or Flow automation\n\n3. Compare the inventory to the query results to identify discrepancies\n\n4. Verify the inventory includes: identity name, type, purpose, business owner, creation date, and last login date\n\n5. Confirm the inventory is reviewed and updated at least quarterly",
      "remediation": "1. Query Salesforce to identify all potential non-human identities using the criteria in the audit procedure\n\n2. For each identified identity, document: name, type (integration/bot/API), purpose, business owner, creation date\n\n3. Establish a process to update the inventory when non-human identities are created, modified, or deactivated\n\n4. Implement quarterly reviews of the inventory to identify and deactivate unused accounts\n\n5. Store the inventory in an authoritative system of record accessible to security and compliance teams",
      "default_value": "Salesforce does not provide a built-in inventory or classification system for non-human identities. Organizations must create and maintain this inventory manually or through third-party tools.",
      "remediation_scope": {
        "scope": "inventory",
        "entity_type": ""
      },
      "task": {
        "title_template": "Establish and maintain inventory of non-human identities"
      }
    },
    {
      "control_id": "SBS-ACS-008",
      "category": "Access Controls",
      "category_description": "This section defines controls related to permission sets, permission set groups, profiles, and access governance within Salesforce environments. These controls ensure that organizations maintain a structured, documented, and enforced approach to authorization management, reducing privilege sprawl and unauthorized access risks.",
      "title": "Restrict Broad Privileges for Non-Human Identities",
      "statement": "Non-human identities must not be assigned permissions that bypass sharing rules or grant administrative capabilities unless documented business justification exists.",
      "description": "Non-human identities should follow the principle of least privilege and be granted only the minimum permissions necessary to perform their intended function. Permissions that bypass object-level or record-level security (such as View All Data, Modify All Data) or grant administrative capabilities (such as Manage Users, Modify Metadata) create significant security risk when assigned to automated accounts. Organizations must document a specific business justification for any non-human identity that requires such permissions.",
      "risk": "Without documented justification for broad non-human identity privileges, organizations lose visibility into which automated systems can bypass sharing rules or perform administrative operations. Non-human identities operate without human judgment, making over-privileged automation a high-impact target\u2014compromised credentials can result in complete data extraction, system-wide configuration changes, or persistent backdoor access. Many non-human identities are granted excessive permissions during initial setup and never reviewed, creating long-lived security exposure that security teams cannot detect, investigate, or remediate without knowing which identities have which privileges and why.",
      "risk_level": "High",
      "audit_procedure": "1. Using the non-human identity inventory from SBS-ACS-006, identify all non-human identities\n\n2. For each non-human identity, query assigned permissions through profiles, permission sets, and permission set groups\n\n3. Flag any non-human identity with one or more of the following permissions:\n\n   - View All Data\n\n   - Modify All Data\n\n   - Manage Users\n\n   - Author Apex\n\n   - Customize Application\n\n   - Any permission that bypasses sharing rules or grants administrative access\n\n4. For each flagged identity, verify that documented business justification exists explaining why the permission is required\n\n5. Confirm the justification was approved by appropriate stakeholders (security, compliance, or management)",
      "remediation": "1. For each non-human identity with broad privileges, evaluate whether the permission is genuinely required for the identity's function\n\n2. Remove broad privileges that are not necessary; replace with more granular permissions where possible\n\n3. For non-human identities that legitimately require broad privileges, document:\n\n   - Specific business function requiring the permission\n\n   - Why more granular permissions cannot satisfy the requirement\n\n   - Business owner and technical owner\n\n   - Approval from security or compliance team\n\n4. Implement a formal approval process for granting broad privileges to non-human identities\n\n5. Establish periodic review (at least annually) of all non-human identities with broad privileges",
      "default_value": "Salesforce does not restrict the assignment of broad privileges to non-human identities. Administrators can grant any permission to any user type without requiring justification or approval.",
      "remediation_scope": {
        "scope": "entity",
        "entity_type": "User"
      },
      "task": {
        "title_template": "Document justification for broad privileges on non-human identity: {{entity.name}}"
      }
    },
    {
      "control_id": "SBS-ACS-009",
      "category": "Access Controls",
      "category_description": "This section defines controls related to permission sets, permission set groups, profiles, and access governance within Salesforce environments. These controls ensure that organizations maintain a structured, documented, and enforced approach to authorization management, reducing privilege sprawl and unauthorized access risks.",
      "title": "Implement Compensating Controls for Privileged Non-Human Identities",
      "statement": "Non-human identities with permissions that bypass sharing rules or grant administrative capabilities must have compensating controls implemented to mitigate risk.",
      "description": "When non-human identities require broad privileges for legitimate business purposes, organizations must implement defense-in-depth protections to reduce the risk of credential compromise or misuse. Compensating controls include IP address restrictions, OAuth scope limitations, activity monitoring and alerting, credential rotation policies, and dedicated identities per integration. Multiple compensating controls should be implemented based on the sensitivity of accessible data and the scope of granted permissions.",
      "risk": "Without compensating controls, privileged non-human identities rely solely on credential secrecy for protection\u2014a single point of failure. Unlike human users, these identities typically use persistent credentials (API keys, OAuth tokens, certificates) that do not expire and are not protected by multi-factor authentication. Compensating controls provide defense-in-depth: IP restrictions limit where credentials can be used, monitoring enables detection of compromise, and credential rotation limits the window of exposure. However, other controls (SBS-ACS-008) still govern whether broad privileges are granted; compensating controls reduce blast radius rather than establishing the primary security boundary.",
      "risk_level": "Moderate",
      "audit_procedure": "1. Using the results from SBS-ACS-007, identify all non-human identities with broad privileges that have documented business justification\n\n2. For each privileged non-human identity, verify that at least two of the following compensating controls are implemented:\n\n   - **IP Address Restrictions:** Profile or permission set restricts login to specific IP ranges\n\n   - **OAuth Scope Limitations:** Connected app uses minimal OAuth scopes; refresh tokens have expiration\n\n   - **Activity Monitoring:** Automated monitoring alerts on unusual activity (off-hours access, high volume, geographic anomalies)\n\n   - **Credential Rotation:** Credentials are rotated at least every 90 days\n\n   - **Dedicated Identity:** Separate identity per integration (not shared across multiple systems)\n\n3. Verify that monitoring alerts are actively reviewed and responded to\n\n4. Confirm that compensating controls are documented in the justification for the privileged access",
      "remediation": "1. For each privileged non-human identity, implement IP address restrictions in the assigned profile or permission set to limit access to known integration sources\n\n2. For OAuth-based integrations, configure connected apps with minimal required scopes and enable refresh token expiration\n\n3. Implement automated monitoring for privileged non-human identity activity using Event Monitoring, Shield Event Monitoring, or third-party SSPM tools\n\n4. Establish credential rotation policies requiring API keys, passwords, and certificates to be rotated at least every 90 days\n\n5. Ensure each integration uses a dedicated non-human identity rather than sharing credentials across multiple systems\n\n6. Document all implemented compensating controls in the access justification",
      "default_value": "Salesforce does not require or enforce compensating controls for privileged non-human identities. IP restrictions, OAuth scopes, monitoring, and credential rotation must be configured manually by administrators.\n\nSalesforce does not require creating and assigning custom profiles.",
      "remediation_scope": {
        "scope": "entity",
        "entity_type": "User"
      },
      "task": {
        "title_template": "Implement compensating controls for privileged non-human identity: {{entity.name}}"
      }
    },
    {
      "control_id": "SBS-ACS-010",
      "category": "Access Controls",
      "category_description": "This section defines controls related to permission sets, permission set groups, profiles, and access governance within Salesforce environments. These controls ensure that organizations maintain a structured, documented, and enforced approach to authorization management, reducing privilege sprawl and unauthorized access risks.",
      "title": "Enforce Periodic Access Review and Recertification",
      "statement": "All user access and configuration influencing permissions and sharing must be formally reviewed and recertified at least annually by designated busines stakeholders, with documented approval and remediation of unauthorized or excessive access.",
      "description": "The organization must implement a periodic access review process that ensures all active user access (human and non-human) is intentional, necessary, and aligned with current job responsibilities. An access review encompasses all authorization constructs including user profiles, permission set assignments, permission set group memberships, and role hierarchies. A designated business stakeholder (typically a manager, department lead, or data owner) must certify that each user's access is appropriate, with documented evidence of review and approval. Any access identified as excessive, outdated, or no longer required must be documented and remediated within a defined timeframe. The review must include both individual user access and permission construct usage.\nThe process must establish clear ownership, defined frequency (minimum annual but may be more frequent for sensitive roles or data), and tracked remediation of findings. Organizations may conduct reviews by individual, by business unit, by data classification, or by application\u2014but all access must be reviewed at least annually in aggregate.\n\n**Example implementations:**\n\n* Annual access reviews conducted by department managers in Q1, with remediation required within 30 days; tracked in a centralized system of record with sign-off by a representative of Business and Security\n\n* Rolling quarterly reviews where each business unit certifies access for their users on a rotating schedule, with all users reviewed within the calendar year\n\n* Role-based reviews where each application owner certifies all users assigned to specific permission sets or profiles, ensuring full coverage across all users annually\n\n* Sensitive role reviews conducted semi-annually (e.g., System Administrator, Finance, HR users) while standard users are reviewed annually",
      "risk": "Access review is the foundational control for preventing privilege creep, detecting unauthorized access, and remediating execessive permissions. Without periodic review, users accumulate access over time -- permissions granted for past roles remain after job changes, access added for temporary projects becomes permanent, and no formal mechanism ensures access remains least-privilege. Periodic formal recertification by business stakeholders ensures that access governance remains aligned with organizational reality. Documentation of review creates an audit trail and ensures accountability. Regular remediation prevents drift and maintains the integrity of the permission set model defined in SBS-ACS-001.",
      "risk_level": "Moderate",
      "audit_procedure": "1. Understand the organization's dcoumented access review policy, including:\n\n   * Defined frequency and review cycle\n\n   * Designated reviewers and escalation path\n\n   * Intended coverage scope and access types included\n\n   * Expected remediation timeframe for findings\n\n   * System of record for tracking review activity and findings.\n\n2. Assess the recency and regularity of access review execution. Locate the most recent completed acccess review cycle and evaluate whether it aligns with the organization's stated review frequency.\n\n3. Examine a representative sample of access review documentation to asssess consistency of execution:\n\n   * Evidence of review and approval by the designated stakeholder\n\n   * Documentation of review date and scope\n\n   * Any findings, exceptions, or questions raised during the review\n\n   * Appropriateness of sample size relative to the organization's user population and complexity\n\n4. For any access identified as excessive, unauthorized, or not recertified:\n\n   * Assess whether the finding was documented\n\n   * Evaluate what remediation action was taken or whether exceptions were formally approved\n\n   * Compare remediation timing against the defined SLA\n\n5. Assess whether the organization maintains a traceable system of record that documents:\n\n   * Who reviewed what access\n\n   * When the review occurred\n\n   * What was approved or questioned\n\n   * What remediation was required and its completion status\n\n6. Evaluate whether the access review process adequately addresses the organization's primary access constructs, which may include the following types of assignment:\n\n   * User profiles\n\n   * Permission sets\n\n   * Permission set groups\n\n   * Role and role hierarchies\n\n   * Public group \n\n   * Queues\n\n   * Sales Territories\n\n   * Delegated administration or elevated permissions",
      "remediation": "1. If no access review process exists, establish documented policy including frequency, reviewers, scope, and remediation SLAs.\n\n2. Conduct an initial comprehensive access review of all active users, with business unit or department ownership of sign-off.\n\n3. Identify and remediate all access determined excessive, unauthorized, or inappropriate during the initial review.\n\n4. Implement a system of record (spreadsheet, governance tool, or integrated platform) to track reviews, findings, and remediation.\n\n5. Schedule recurring access reviews at minimum annual frequency, with quarterly reviews for sensitive roles or high-risk data.\n\n6. Document the review process, including templates, stakeholder roles, and escalation procedures.\n\n7. Establish accountability for reviewers and tie review completion to performance management or audit requirements.",
      "default_value": "Salesforce does not automatically initiate user access reviews or require stakeholder recertification of access. Organizations must manually track and document access review processes. Without a defined process, access authorization decisions are not systematically validated, and no audit trail of business stakeholder approval exists.",
      "remediation_scope": {
        "scope": "mechanism",
        "entity_type": ""
      },
      "task": {
        "title_template": "Implement periodic access review and recertification process with documented stakeholder approval"
      }
    },
    {
      "control_id": "SBS-ACS-011",
      "category": "Access Controls",
      "category_description": "This section defines controls related to permission sets, permission set groups, profiles, and access governance within Salesforce environments. These controls ensure that organizations maintain a structured, documented, and enforced approach to authorization management, reducing privilege sprawl and unauthorized access risks.",
      "title": "Enforce Governance of Access and Authorization Changes",
      "statement": "All changes to Salesforce user access and authorization must be governed through a documented process that requires approval, records business justification, and produces an auditable record of the change.",
      "description": "Organizations must enforce governance over all changes that grant, modify, or revoke access within Salesforce. Access and authorization changes must be requested, approved prior to implementation, and traceable to a documented business justification.\n\nThis control applies to changes including, but not limited to:\n\n- User creation, modification, or deactivation\n\n- Assignment or removal of profiles, permission sets, or permission set groups\n\n- Changes to profile or permission set permissions\n\n- Role hierarchy changes\n\n- Public group, queue, or territory access changes\n\n- Sharing rule or restriction rule changes affecting access\n\nAccess changes must be auditable and aligned to the organization's documented access model. Unauthorized or undocumented changes represent control failure.",
      "risk": "Without enforced governance over access changes, organizations lose visibility and control over how privileges are granted and modified. Ad hoc access changes increase the risk of excessive privileges, unauthorized access, and violations of least-privilege principles. The absence of approval, justification, or auditability impairs incident investigation, undermines access reviews, and weakens compliance evidence for audits involving identity, access management, and change control.",
      "risk_level": "High",
      "audit_procedure": "1. Retrieve evidence of the organization's documented process governing access and authorization changes.  \n\n2. Identify access-related changes made during a representative review period.  \n\n3. For a sample of changes, verify:  \n\n   - An approval record exists prior to implementation  \n\n   - Business justification is documented  \n\n   - The change is traceable to an identifiable request  \n\n   - The implemented change is recorded in available audit or change history records  \n\n4. Identify any access changes lacking approval, justification, or auditability as noncompliant.",
      "remediation": "1. Establish and document a formal governance process for access and authorization changes.  \n\n2. Require approval and business justification for all access modifications.  \n\n3. Ensure access changes are recorded in an auditable system of record.",
      "default_value": "Salesforce does not enforce approval workflows or governance for access and authorization changes. Administrators can directly modify users, permissions, roles, and sharing settings without documented approval or justification. While certain changes may appear in audit logs, governance enforcement is dependent on organizational policy and external processes.",
      "remediation_scope": {
        "scope": "mechanism",
        "entity_type": ""
      },
      "task": {
        "title_template": "Establish governance process for access and authorization changes with approval and audit trail"
      }
    },
    {
      "control_id": "SBS-ACS-012",
      "category": "Access Controls",
      "category_description": "This section defines controls related to permission sets, permission set groups, profiles, and access governance within Salesforce environments. These controls ensure that organizations maintain a structured, documented, and enforced approach to authorization management, reducing privilege sprawl and unauthorized access risks.",
      "title": "Classify Users for Login Hours Restrictions",
      "statement": "Organizations must maintain a documented classification of users requiring login hours restrictions or equivalent off-hours authentication monitoring.",
      "description": "Organizations must perform risk-based classification to identify users for whom off-hours authentication poses elevated security risk. For each classified user, organizations must either configure login hours restrictions on their profile or implement monitoring and alerting for off-hours authentication. Organizations may classify zero users if documented and reviewed periodically.",
      "risk": "When privileged accounts authenticate without time restrictions or monitoring, compromised credentials can be exploited during off-hours when detection is less likely. Login hours or monitoring provides defense-in-depth by limiting attack windows or enabling investigation. However, this requires credential compromise and does not establish a primary boundary\u2014authentication controls (SBS-AUTH-001) and IP restrictions (SBS-AUTH-003) remain primary protections.",
      "risk_level": "Moderate",
      "audit_procedure": "1. Verify the organization maintains a documented classification identifying users requiring login hours restrictions or monitoring.  \n\n2. For classified users, verify login hours are configured or off-hours authentication monitoring is implemented.  \n\n3. If zero users are classified, verify this decision is documented with justification and reviewed periodically.",
      "remediation": "1. Perform risk-based user classification based on privileges and data access.  \n\n2. For classified users, either configure login hours on profiles or implement off-hours authentication monitoring with alerting.  \n\n3. Document classification and implementation decisions in a system of record.  \n\n4. Review during periodic access reviews (SBS-ACS-010).",
      "default_value": "Salesforce does not enforce login hours or monitor off-hours authentication by default; users can authenticate 24x7 unless explicitly configured.",
      "remediation_scope": {
        "scope": "inventory",
        "entity_type": ""
      },
      "task": {
        "title_template": "Establish and maintain user classification for login hours restrictions"
      }
    },
    {
      "control_id": "SBS-AUTH-001",
      "category": "Authentication",
      "category_description": "This section defines controls related to user authentication in Salesforce production environments. These controls ensure that organizations implement strong identity verification mechanisms, centralize authentication through Single Sign-On, and maintain proper governance over authentication exceptions to reduce the attack surface and enforce consistent identity management practices.",
      "title": "Enable Organization-Wide SSO Enforcement Setting",
      "statement": "Salesforce production orgs must enable the org-level setting that disables Salesforce credential logins for all users.",
      "description": "Production orgs must enforce SSO authentication at the organizational level by enabling the \"Disable login with Salesforce credentials\" setting. This setting prevents all users from authenticating with Salesforce usernames and passwords, requiring SSO authentication instead. Individual users can still be exempted from this requirement using the \"Is Single Sign-On Enabled\" permission (governed by SBS-AUTH-002).",
      "risk": "Without the org-level SSO enforcement setting enabled, users can authenticate directly to Salesforce using local credentials\u2014creating a parallel authentication path outside centralized identity management. This establishes an uncontrolled security boundary: password-based attacks (credential stuffing, phishing, brute force) can target Salesforce directly, enabling unauthorized access without requiring any other control to fail. Attackers bypass organizational identity controls, MFA policies, and session management enforced at the IdP layer. This setting is the primary technical control that establishes the SSO security boundary.",
      "risk_level": "Critical",
      "audit_procedure": "1. Retrieve `SingleSignOnSettings` (part of `SecuritySettings`) via Metadata API or navigate to Setup \u2192 Single Sign-On Settings in the UI.\n\n2. Verify that `isLoginWithSalesforceCredentialsDisabled` is set to `true`.\n\n3. Flag the org if the setting is not enabled.",
      "remediation": "1. Navigate to Setup \u2192 Single Sign-On Settings.\n\n2. Enable **Disable login with Salesforce credentials**.\n\n3. Validate that SSO is properly configured and functional before enabling this setting to prevent lockout.\n\n4. Ensure approved break-glass or administrative accounts have the \"Is Single Sign-On Enabled\" permission removed via their profiles or permission sets so they can still authenticate if needed.",
      "default_value": "By default, Salesforce does not enable \"Disable login with Salesforce credentials.\" All users can authenticate with Salesforce usernames and passwords unless this setting is explicitly enabled.",
      "remediation_scope": {
        "scope": "org",
        "entity_type": ""
      },
      "task": {
        "title_template": "Enable org-wide SSO enforcement setting"
      }
    },
    {
      "control_id": "SBS-AUTH-002",
      "category": "Authentication",
      "category_description": "This section defines controls related to user authentication in Salesforce production environments. These controls ensure that organizations implement strong identity verification mechanisms, centralize authentication through Single Sign-On, and maintain proper governance over authentication exceptions to reduce the attack surface and enforce consistent identity management practices.",
      "title": "Govern and Document All Users Permitted to Bypass Single Sign-On",
      "statement": "All users who do not have the \"Is Single Sign-On Enabled\" permission must be explicitly authorized, documented in a system of record, and limited to approved administrative or break-glass use cases.",
      "description": "When the org-level SSO enforcement setting (SBS-AUTH-001) is enabled, users without the \"Is Single Sign-On Enabled\" permission can still authenticate using Salesforce credentials\u2014effectively bypassing SSO. Production orgs must maintain an authoritative inventory of all such accounts, documenting their justification, role, and approval. These accounts should be limited to approved administrative or break-glass scenarios only.",
      "risk": "Users permitted to bypass SSO represent exceptions to centralized identity governance. Without formal documentation and approval, these accounts can proliferate unnoticed\u2014reducing visibility into access patterns and undermining audit readiness. However, this control provides assurance and governance rather than establishing a security boundary. Undocumented exceptions increase operational risk and reduce audit readiness but require credential compromise for direct security impact.",
      "risk_level": "Moderate",
      "audit_procedure": "1. Query all user records to identify users who do **not** have the \"Is Single Sign-On Enabled\" (`PermissionsIsSsoEnabled`) permission assigned through their profile or permission sets.\n\n2. Verify each identified user appears in the approved system-of-record inventory with documented business justification, owner, and approval.\n\n3. Confirm each exception is authorized for administrative or break-glass purposes only.\n\n4. Validate that these accounts follow strong local authentication controls (e.g., strong password policies, MFA if applicable).\n\n5. Flag any user without documented approval.\n\n6. (Optional) Download API Total Usage logs (EventLogFile - ApiTotalUsage, available in free tier of Event Monitoring) to monitor SSO bypass account activity:\n\n   - Filter API activity by users identified as SSO bypass accounts.\n\n   - Review frequency and timing of API calls to verify usage aligns with documented break-glass purposes.\n\n   - Flag any SSO bypass accounts with regular or unexpected API activity for review against documented justifications.",
      "remediation": "1. Create or update a formal inventory documenting all SSO-bypass users with their business justification, owner, and approval date.\n\n2. For any undocumented or unjustified users: assign the \"Is Single Sign-On Enabled\" permission via their profile or permission sets to remove SSO-bypass capability.\n\n3. Ensure all documented exceptions adhere to least-privilege access and strong authentication controls.  \n\n4. Establish periodic (e.g., quarterly) review of all SSO-bypass accounts.",
      "default_value": "By default, no users are assigned the \"Is Single Sign-On Enabled\" permission, meaning all users can authenticate with Salesforce credentials. Once SBS-AUTH-001 is implemented and the org-level setting is enabled, users must be explicitly assigned this permission to require SSO authentication.",
      "remediation_scope": {
        "scope": "entity",
        "entity_type": "User"
      },
      "task": {
        "title_template": "Review and justify SSO bypass user: {{entity.name}}"
      }
    },
    {
      "control_id": "SBS-AUTH-003",
      "category": "Authentication",
      "category_description": "This section defines controls related to user authentication in Salesforce production environments. These controls ensure that organizations implement strong identity verification mechanisms, centralize authentication through Single Sign-On, and maintain proper governance over authentication exceptions to reduce the attack surface and enforce consistent identity management practices.",
      "title": "Prohibit Broad or Unrestricted Profile Login IP Ranges",
      "statement": "Profiles in Salesforce production orgs must not contain login IP ranges that effectively permit access from the full public internet or other overly broad ranges that bypass network-based access controls.",
      "description": "Any profile-level login IP range must reflect explicitly authorized organizational network boundaries. Profiles must not include universally permissive ranges\u2014such as `0.0.0.0\u2013255.255.255.255` or other combinations that allow access from all or nearly all IP addresses\u2014as these configurations disable intended Salesforce network restrictions and undermine authentication controls.",
      "risk": "Overly broad login IP ranges effectively disable network-based access controls, allowing authentication from any location on the internet. However, exploitation requires credentials to be compromised first\u2014this control provides defense-in-depth rather than establishing a primary security boundary. When authentication controls (SBS-AUTH-001) are enforced, IP restrictions serve as an additional layer that limits the blast radius of credential compromise.",
      "risk_level": "Moderate",
      "audit_procedure": "1. Retrieve all profile login IP ranges via **Setup \u2192 Profiles \u2192 Login IP Ranges** or by querying the Profile metadata (`loginIpRanges` field) using the Metadata API.\n\n2. For each profile, enumerate all configured login IP ranges.\n\n3. Identify any ranges that:\n\n   - Cover the entire IPv4 space, or\n\n   - Represent effectively unrestricted access (e.g., `0.0.0.0\u2013255.255.255.255`, `1.1.1.1\u2013255.255.255.255`, or similar patterns).\n\n4. Confirm that all IP ranges align with organizational security policy and defined network boundaries.\n\n5. Flag any profile with an impermissible or overly broad range.\n\n6. Download API Total Usage logs (EventLogFile - ApiTotalUsage, available in free tier of Event Monitoring) to validate IP restrictions are effective:\n\n   - Extract unique `CLIENT_IP` values from recent API activity.\n\n   - Compare against documented approved organizational network ranges.\n\n   - Identify any new or unexpected IP addresses making API calls.\n\n   - Cross-reference unusual IPs with profile assignments to identify potential policy gaps.",
      "remediation": "1. Remove any profile login IP ranges that effectively grant unrestricted global access.  \n\n2. Replace them with IP ranges that correspond to approved corporate networks, office locations, VPN ingress points, or other authorized infrastructure.  \n\n3. Validate that updated network restrictions do not block legitimate access paths and that users can authenticate through sanctioned networks.  \n\n4. Establish an internal governance process to review and approve all future additions of profile login IP ranges.",
      "default_value": "Salesforce profiles do not include login IP ranges by default; they must be explicitly configured.",
      "remediation_scope": {
        "scope": "entity",
        "entity_type": "Profile"
      },
      "task": {
        "title_template": "Remove unrestricted IP ranges from profile: {{entity.name}}"
      }
    },
    {
      "control_id": "SBS-AUTH-004",
      "category": "Authentication",
      "category_description": "This section defines controls related to user authentication in Salesforce production environments. These controls ensure that organizations implement strong identity verification mechanisms, centralize authentication through Single Sign-On, and maintain proper governance over authentication exceptions to reduce the attack surface and enforce consistent identity management practices.",
      "title": "Enforce Strong Multi-Factor Authentication for External Users with Substantial Access to Sensitive Data",
      "statement": "All Salesforce interactive authentication flows for external human users with substantial access to sensitive data must enforce multi-factor authentication that includes at least one strong authentication factor.",
      "description": "Salesforce must be configured so that every interactive login method available to external human users with substantial access to sensitive data enforces multi-factor authentication using either a strong second factor in addition to a password, or a passwordless flow requiring two or more factors with at least one strong factor, regardless of whether authentication is performed directly by Salesforce or via a single sign-on identity provider.\n\nOrganizations must document in their system of record:\n\n1. **Definition of \"substantial access to sensitive data\"** \u2014 The organization's interpretation of what data classifications or access levels constitute substantial access for purposes of this control.\n\n2. **Identification of in-scope users** \u2014 Either a list of specific users, or the combination of Salesforce access controls (profiles, permission sets, etc.) that result in substantial access.\n\n**Example system-of-record entry:**\n\n- **Definition:** \"Substantial access to sensitive data\" means access to Personally Identifiable Information (as defined under GDPR) relating to individuals other than the user themselves, or access to Special Category Data (as defined under GDPR) relating to any individual.\n\n- **In-scope users:** All users assigned the \"Service Channel Partner\" profile.\n\nFor the purposes of this control, a strong authentication factor is defined as an authentication factor that is resistant to phishing, replay, and credential stuffing attacks. Acceptable strong authentication factors include:\n\n - Push-notification based authenticator app such as Salesforce Authenticator or Okta Verify\n\n - RFC 6238 compliant Time-based One-Time Password Algorithm (TOTP) authenticator app\n\n - FIDO2 hardware key compliant with either WebAuthn or U2F standard\n\n - Biometric authentication such as Touch ID or Windows Hello",
      "risk": "Without enforced multi-factor authentication, external users with substantial access to sensitive data can authenticate using only a password\u2014establishing a single point of failure for the authentication boundary. External users present elevated credential risk due to weaker identity proofing, less organizational oversight, and exposure to consumer-grade phishing attacks. Attackers who compromise a single password through phishing, credential stuffing, or account takeover gain direct access to sensitive data without requiring any other control to fail. This creates an unprotected authentication path to high-value data that bypasses the defense-in-depth protections applied to internal users.",
      "risk_level": "",
      "audit_procedure": "1. Enumerate all active external human users with substantial access to sensitive data.\n\n2. Validate that in-scope users have the \u201cMulti-Factor Authentication for User Interface Logins\u201d permission through profiles or permission sets.\n\n3. Flag any in-scope users who lack the \u201cMulti-Factor Authentication for User Interface Logins\u201d permission.",
      "remediation": "1. Apply the \u201cMulti-Factor Authentication for User Interface Logins\u201d permission through profiles or permission sets for all active external users with substantial access to sensitive data.\n\n2. Configure suitable strong second-factor options in Setup -> Identity -> Identity Verification (e.g., authenticator app, FIDO2 security key).",
      "default_value": "By default, Salesforce does not enforce strong multi-factor authentication for all external user login flows, and external users may authenticate using single-factor or weak-factor methods unless explicitly restricted by configuration.\n\n**References:**  \n\n- Salesforce Documentation: Multi-Factor Authentication  \n\n- NIST SP 800-63B Authentication and Lifecycle Management  \n\n- NIST SP 800-53 IA-2",
      "remediation_scope": {
        "scope": "entity",
        "entity_type": "User"
      },
      "task": {
        "title_template": "Enable 'Multi-Factor Authentication for User Interface Logins' for external users with substantial access to sensitive data"
      }
    },
    {
      "control_id": "SBS-CODE-001",
      "category": "Code Security",
      "category_description": "This section defines controls related to secure development practices for Salesforce code, including Apex, Lightning Web Components, and other programmatic assets. These controls ensure that organizations implement quality gates, peer review, and automated security testing within their development lifecycle to prevent vulnerable or flawed code from entering production environments.",
      "title": "Mandatory Peer Review for Salesforce Code Changes",
      "statement": "All Salesforce code changes must undergo peer review and receive approval before merging into any production-bound branch.",
      "description": "Organizations must configure their source control system to require at least one peer reviewer to approve all changes to Apex, Lightning Web Components, and other programmatic assets before those changes are merged into branches used for production deployments.",
      "risk": "Without mandatory peer review, a single developer\u2014whether compromised, malicious, or simply mistaken\u2014can introduce insecure or flawed code directly into the deployment pipeline. This eliminates shared oversight of changes to sensitive business logic, allowing vulnerabilities, backdoors, or destructive changes to reach production without independent human verification before deployment.",
      "risk_level": "Moderate",
      "audit_procedure": "1. Inspect source control settings to confirm merge rules require peer review on production-bound branches.  \n\n2. Review merge history or representative pull requests to verify peer approvals were recorded.  \n\n3. Confirm that peer review processes include security checks such as verifying logging statements do not expose sensitive data.\n\n4. Flag any repositories or branches that allow merging without peer approval.",
      "remediation": "1. Update branch protection rules to require peer review before merge.  \n\n2. Train developers on the peer review workflow, including security checks such as identifying sensitive data in logging statements.  \n\n3. Block direct commits to production-bound branches.",
      "default_value": "Salesforce does not enforce code review requirements; these controls depend on the organization's source control configuration.",
      "remediation_scope": {
        "scope": "mechanism",
        "entity_type": ""
      },
      "task": {
        "title_template": "Implement mandatory peer review for Salesforce code changes"
      }
    },
    {
      "control_id": "SBS-CODE-002",
      "category": "Code Security",
      "category_description": "This section defines controls related to secure development practices for Salesforce code, including Apex, Lightning Web Components, and other programmatic assets. These controls ensure that organizations implement quality gates, peer review, and automated security testing within their development lifecycle to prevent vulnerable or flawed code from entering production environments.",
      "title": "Pre-Merge Static Code Analysis for Apex and LWC",
      "statement": "Static code analysis with security checks for Apex and Lightning Web Components must execute successfully before any code change is merged into a production-bound branch.",
      "description": "Organizations must implement static application security testing (SAST) in their CI/CD pipeline and configure it to run prior to merge, enforcing security rulesets that detect vulnerabilities specific to Apex and LWC.",
      "risk": "Without enforced static code analysis, known vulnerability patterns in Apex and LWC\u2014such as SOQL injection, insecure data exposure, and improper access control\u2014may enter production undetected. This increases the likelihood of exploitable flaws persisting in deployed code, creating potential vectors for data breaches or unauthorized access that human reviewers may not catch.",
      "risk_level": "Moderate",
      "audit_procedure": "1. Inspect CI/CD pipeline configuration to confirm a static code analysis step runs before merges.  \n\n2. Verify the SAST tool includes security rulesets for Apex and Lightning Web Components.  \n\n3. Review pipeline logs from representative merges to ensure scans executed and passed.  \n\n4. Flag pipelines or branches missing enforced pre-merge scanning.",
      "remediation": "1. Integrate static code analysis into the CI/CD pipeline for all production-bound branches.  \n\n2. Enable Apex and LWC security rulesets within the scanning tool.  \n\n3. Configure pipelines to block merges when static analysis fails.",
      "default_value": "Salesforce does not provide or enforce static code analysis; organizations must implement external SAST tooling.",
      "remediation_scope": {
        "scope": "mechanism",
        "entity_type": ""
      },
      "task": {
        "title_template": "Implement pre-merge static code analysis for Apex and LWC"
      }
    },
    {
      "control_id": "SBS-CODE-003",
      "category": "Code Security",
      "category_description": "This section defines controls related to secure development practices for Salesforce code, including Apex, Lightning Web Components, and other programmatic assets. These controls ensure that organizations implement quality gates, peer review, and automated security testing within their development lifecycle to prevent vulnerable or flawed code from entering production environments.",
      "title": "Implement Persistent Apex Application Logging",
      "statement": "Organizations must implement an Apex-based logging framework that writes application log events to durable Salesforce storage and must not rely on transient Salesforce debug logs for operational or security investigations.",
      "description": "The organization must deploy a dedicated Apex logging framework\u2014custom-built, open source, or vendor-provided\u2014that programmatically captures application-level log events and stores them in durable Salesforce data structures, such as custom objects, to ensure logs persist beyond the limitations of Salesforce debug logs.",
      "risk": "Salesforce debug logs are transient, size-limited, and automatically purged\u2014making them unsuitable for forensic analysis or security investigations. Without persistent application logging, organizations cannot reliably reconstruct access patterns, detect anomalous behavior, or investigate security incidents after the fact. This impairs the ability to identify compromise, attribute malicious activity, or understand the scope of a breach\u2014significantly extending attacker dwell time and reducing accountability for actions taken within the system.",
      "risk_level": "High",
      "audit_procedure": "1. Review the Salesforce org for the presence of an Apex logging framework implemented as one or more Apex classes dedicated to log generation and persistence.  \n\n2. Verify that the framework writes logs to durable storage, such as a custom object purpose-built for log retention.  \n\n3. Confirm that operational and security investigations rely on this persistent logging mechanism rather than Salesforce debug logs.  \n\n4. Inspect recent log records to ensure the framework is actively capturing runtime events.",
      "remediation": "1. Implement or install an Apex logging framework designed for persistent log storage.  \n\n2. Create or configure a custom object (or equivalent durable storage) to store log records.  \n\n3. Update Apex code to route log events through the framework.  \n\n4. Train engineering and security teams to use persistent logs instead of debug logs for investigations.",
      "default_value": "Salesforce does not provide persistent application-level logging by default; debug logs are transient, size-limited, and automatically purged.",
      "remediation_scope": {
        "scope": "mechanism",
        "entity_type": ""
      },
      "task": {
        "title_template": "Implement persistent Apex application logging framework"
      }
    },
    {
      "control_id": "SBS-CODE-004",
      "category": "Code Security",
      "category_description": "This section defines controls related to secure development practices for Salesforce code, including Apex, Lightning Web Components, and other programmatic assets. These controls ensure that organizations implement quality gates, peer review, and automated security testing within their development lifecycle to prevent vulnerable or flawed code from entering production environments.",
      "title": "Prevent Sensitive Data in Application Logs",
      "statement": "Custom application logging frameworks and Salesforce system logging mechanisms must not capture, store, or transmit credentials, authentication tokens, personally identifiable information (PII), regulated data, or other sensitive values in log messages or structured log fields.",
      "description": "Organizations must ensure that custom Apex logging frameworks and Salesforce debug logs exclude sensitive data from all log outputs. This applies to:\n\n- Custom logging frameworks writing to custom objects or external systems\n\n- `System.debug()` statements that write to Salesforce debug logs\n\n- Error handling routines that log exception details\n\nLogging implementations must prevent the capture of:\n\n- Authentication credentials including passwords, API keys, OAuth tokens, session identifiers, and client secrets\n\n- Personally identifiable information and regulated data such as SSNs, financial account numbers, credit card details, and protected health information\n\n- Full SOQL query results containing sensitive fields (log record IDs or counts instead)\n\n- Request/response payloads containing authentication headers or authorization tokens\n\n- Unmasked field values from high-sensitivity objects (mask or tokenize before logging)\n\nOrganizations must implement mechanisms to prevent sensitive data from being written to logs, such as sanitization functions that developers invoke to remove or mask data before log events are persisted, or establishing code review requirements that check for sensitive data exposure in logging calls.",
      "risk": "When application logs capture sensitive data, attackers who compromise low-privilege accounts with Read access to log storage can exfiltrate credentials, PII, or regulated data without triggering access controls on the original source objects\u2014transforming a logging framework into a data leakage vector. In regulated industries, a compromised administrator querying log objects can extract thousands of customer records in minutes, with the audit trail showing only \"legitimate\" queries. During breach investigations, logs become evidence of regulatory violations rather than forensic tools, triggering consent orders and significant financial penalties.",
      "risk_level": "Critical",
      "audit_procedure": "1. Sample representative Apex classes from high-risk areas (customer-facing functionality, payment processing, authentication flows) to identify logging statements in both custom frameworks and `System.debug()` calls.  \n\n2. Examine log message construction to detect patterns that may capture the types of sensitive data listed above.\n\n3. Query recent log records stored in custom objects and review Salesforce debug logs to inspect actual log content for sensitive data:\n\n   - Search for patterns matching SSNs, credit card numbers, email addresses, phone numbers\n\n   - Identify authentication tokens, session IDs, or API keys in log messages\n\n   - Flag any log records containing regulated data or PII\n\n4. Verify that mechanisms exist to prevent sensitive data from being logged (such as sanitization functions, code review checks, or automated validation).",
      "remediation": "1. Implement mechanisms to prevent sensitive data from being written to logs:\n\n   ```apex\n\n   public class SecureLogger {\n\n       public static void logInfo(String message, Map<String, Object> context) {\n\n           // Sanitize context before logging\n\n           Map<String, Object> sanitized = sanitizeContext(context);\n\n           Logger.info(message, sanitized);\n\n       }\n\n       private static Map<String, Object> sanitizeContext(Map<String, Object> ctx) {\n\n           Map<String, Object> result = new Map<String, Object>();\n\n           for (String key : ctx.keySet()) {\n\n               // Mask sensitive fields, log IDs instead of full records\n\n               if (key.containsIgnoreCase('password') || \n\n                   key.containsIgnoreCase('token') || \n\n                   key.containsIgnoreCase('ssn')) {\n\n                   result.put(key, '***REDACTED***');\n\n               } else if (ctx.get(key) instanceof SObject) {\n\n                   result.put(key, ((SObject)ctx.get(key)).Id);\n\n               } else {\n\n                   result.put(key, ctx.get(key));\n\n               }\n\n           }\n\n           return result;\n\n       }\n\n   }\n\n   ```\n\n2. Audit existing log records in custom objects and purge Salesforce debug logs containing sensitive data.  \n\n3. Update logging calls to avoid capturing sensitive data:\n\n   ```apex\n\n   // BAD - logs full account with SSN field\n\n   System.debug('Processing: ' + acc);\n\n   Logger.info('Processing account', new Map<String, Object>{'account' => acc});\n\n   // GOOD - logs only record ID\n\n   System.debug('Processing account: ' + acc.Id);\n\n   SecureLogger.logInfo('Processing account', new Map<String, Object>{\n\n       'accountId' => acc.Id,\n\n       'recordCount' => 1\n\n   });\n\n   ```\n\n4. Consider implementing compensating controls such as automated testing that validates log outputs for sensitive data patterns, code review checks for logging security, or static analysis rules that detect common sensitive data exposure patterns.",
      "default_value": "Salesforce does not prevent or sanitize sensitive data in custom application logs or system debug logs; developers bear full responsibility for ensuring log content complies with data protection requirements.",
      "remediation_scope": {
        "scope": "entity",
        "entity_type": "Logging Statement"
      },
      "task": {
        "title_template": "Sanitize sensitive data in {{entity.name}} logging call"
      }
    },
    {
      "control_id": "SBS-CPORTAL-001",
      "category": "Customer Portals",
      "category_description": "This section defines controls related to secure configuration and development practices for Salesforce customer portals, including Experience Cloud sites, Communities, and other external-facing Salesforce platforms. These controls ensure that organizations implement proper access controls, data isolation, and secure coding practices when exposing Salesforce functionality to external users.",
      "title": "Prevent Parameter-Based Record Access in Portal Apex",
      "statement": "All Apex methods exposed to customer portal users must not accept user-provided parameters that determine which records are accessed, and must instead derive record access exclusively from the authenticated user's context.",
      "description": "Organizations must architect portal-exposed Apex methods to prevent Insecure Direct Object Reference (IDOR) vulnerabilities by prohibiting acceptance of user-supplied record identifiers, SOQL filter predicates, field selection lists, or relationship traversal parameters. Methods must derive data access from server-side evaluation of the running user's context using `UserInfo` class methods (`UserInfo.getUserId()`, `UserInfo.getContactId()`, etc.) and traverse relationships from the authenticated user's associated records (User \u2192 Contact \u2192 Account) rather than trusting client-side input.\n\nExamples of prohibited parameter patterns include:\n\n- Record IDs passed from the frontend to control which records are queried\n\n- Dynamic WHERE clause components or filter criteria supplied by the user  \n\n- Field lists determining what data is returned via dynamic SOQL\n\n- Parent/child relationship identifiers controlling query scope",
      "risk": "When portal-exposed methods accept user-controlled parameters to determine record access, external users can manipulate these inputs to bypass intended access controls and exfiltrate unauthorized data. By iterating record IDs, modifying query filters, or injecting field names, attackers gain direct access to records beyond their sharing-based permissions\u2014even when proper sharing keywords are declared. This vulnerability is especially severe in customer portal contexts where thousands of external users with adversarial intent can systematically enumerate organizational data. A single method accepting a record ID parameter from the frontend creates a SQL injection-equivalent vulnerability in the Salesforce trust model\u2014allowing attackers to read, modify, or delete data without authentication or authorization checks, independent of any other security control failures. This constitutes a Critical boundary violation: unauthorized users access data they should never see, with no compensating controls required to fail.",
      "risk_level": "Critical",
      "audit_procedure": "1. Identify all Apex classes containing `@AuraEnabled` methods or other methods exposed to customer portal sites.  \n\n2. For each method, examine the parameter list to identify parameters of type `Id`, `String`, `List<Id>`, `List<String>`, `Set<Id>`, or `Map<String, Object>` that could control record access.  \n\n3. Review the method implementation to determine if parameters influence SOQL query construction (WHERE clauses, record IDs, field selection, relationship traversal).  \n\n4. Verify that methods derive record access from `UserInfo.getUserId()` or related user context rather than accepting frontend-supplied identifiers.  \n\n5. Conduct penetration testing by attempting to pass unauthorized record IDs or manipulated parameters from portal user sessions.  \n\n6. Flag any method that accepts user-supplied parameters controlling record access as noncompliant.",
      "remediation": "1. Refactor portal-exposed methods to eliminate all parameters that control record access, query scope, or field selection.  \n\n2. Implement server-side logic that determines accessible records based on the running user's context:\n\n   ```apex\n\n   @AuraEnabled\n\n   public static Account getMyAccount() {\n\n       Id userId = UserInfo.getUserId();\n\n       User currentUser = [SELECT ContactId FROM User WHERE Id = :userId];\n\n       Contact portalContact = [SELECT AccountId FROM Contact WHERE Id = :currentUser.ContactId];\n\n       return [SELECT Id, Name FROM Account WHERE Id = :portalContact.AccountId];\n\n   }\n\n   ```\n\n3. For methods that must operate on specific records, validate ownership using `UserRecordAccess` before returning data:\n\n   ```apex\n\n   List<UserRecordAccess> access = [SELECT RecordId, HasReadAccess \n\n                                     FROM UserRecordAccess \n\n                                     WHERE UserId = :UserInfo.getUserId() \n\n                                     AND RecordId = :recordId];\n\n   if (access.isEmpty() || !access[0].HasReadAccess) {\n\n       throw new AuraHandledException('Access denied');\n\n   }\n\n   ```\n\n4. Establish code review requirements that specifically check for parameter-based access control in portal-exposed methods.",
      "default_value": "Salesforce does not prevent or validate user-supplied parameters in custom Apex code. Developers bear full responsibility for implementing access controls.",
      "remediation_scope": {
        "scope": "entity",
        "entity_type": "AuraEnabled Method"
      },
      "task": {
        "title_template": "Refactor {{entity.name}} to use user context instead of parameters"
      }
    },
    {
      "control_id": "SBS-CPORTAL-002",
      "category": "Customer Portals",
      "category_description": "This section defines controls related to secure configuration and development practices for Salesforce customer portals, including Experience Cloud sites, Communities, and other external-facing Salesforce platforms. These controls ensure that organizations implement proper access controls, data isolation, and secure coding practices when exposing Salesforce functionality to external users.",
      "title": "Restrict Guest User Record Access",
      "statement": "Unauthenticated guest users in customer portals must be restricted to authentication and registration flows only, with no direct access to business objects or custom Apex methods that query organizational data.",
      "description": "Organizations must configure customer portal guest user profiles to prohibit access to all business-related standard and custom objects, limiting guest user capabilities exclusively to authentication flows (login, registration, password reset, self-service account creation). Guest users must not be granted object-level permissions, field-level access, or the ability to invoke custom Apex methods that return organizational data.\n\nWhen business requirements necessitate limited guest user access to specific public data (such as knowledge articles, public case submission forms, or product catalogs), organizations must:\n\n- Implement a dedicated service layer architecture where controllers invoke secure service classes that perform explicit access validation\n\n- Use allowlist-based data access (explicitly define queryable records, never accept parameters)\n\n- Apply additional validation using `UserInfo.getUserType() == 'Guest'` to enforce restricted logic paths\n\n- Consider rate limiting and CAPTCHA protection to prevent enumeration attacks",
      "risk": "Guest users represent the highest-risk trust boundary in Salesforce portals\u2014they are unauthenticated, have zero accountability, generate minimal audit trail, and operate with potential adversarial intent. When guest users are granted object permissions or can invoke custom Apex methods, attackers can systematically enumerate organizational data without even creating an account. Historical Salesforce security updates have repeatedly addressed guest user permission defaults because vendors consistently misconfigure this boundary. A single guest-accessible method that queries user records, cases, accounts, or custom objects creates a public API for data exfiltration accessible to anyone on the internet. This constitutes a Critical boundary violation: unauthenticated attackers access organizational data with no authentication required.",
      "risk_level": "Critical",
      "audit_procedure": "1. Identify all guest user profiles used by customer portal sites (typically named \"Site Guest User\" or similar).  \n\n2. Review object-level permissions for guest user profiles and verify that all business-related standard and custom objects have Read, Create, Edit, Delete permissions set to disabled.  \n\n3. Enumerate all custom Apex classes containing `@AuraEnabled` methods and verify that none are accessible to guest users (either by checking profile permissions or testing invocation from guest context).  \n\n4. For any guest-accessible functionality beyond authentication flows, verify implementation of service layer architecture with explicit access controls.  \n\n5. Test by accessing the portal without authentication and attempting to invoke Apex methods or query objects via built-in Lightning controllers.  \n\n6. Flag any guest user object permissions or method access as noncompliant.",
      "remediation": "1. Remove all object-level permissions from guest user profiles except those explicitly required for authentication flows.  \n\n2. Audit and remove guest user access to any custom Apex methods that query or return organizational data.  \n\n3. For public data requirements (knowledge articles, case submission), implement service layer pattern:\n\n   ```apex\n\n   @AuraEnabled\n\n   public static List<Knowledge__kav> getPublicArticles() {\n\n       if (UserInfo.getUserType() == 'Guest') {\n\n           // Allowlist-based, no parameters accepted\n\n           return [SELECT Id, Title, Summary FROM Knowledge__kav \n\n                   WHERE PublicationStatus = 'Online' \n\n                   AND IsVisibleInPkb = true \n\n                   LIMIT 10];\n\n       }\n\n       throw new AuraHandledException('Access denied');\n\n   }\n\n   ```\n\n4. Implement network-level rate limiting and CAPTCHA for guest-accessible endpoints.  \n\n5. Review Salesforce security updates and apply guest user permission restrictions from recent releases.",
      "default_value": "Salesforce has progressively restricted guest user default permissions in recent releases, but older orgs may retain permissive configurations. Guest user profiles do not prevent object access or Apex invocation by default\u2014administrators must explicitly configure restrictions.",
      "remediation_scope": {
        "scope": "org",
        "entity_type": ""
      },
      "task": {
        "title_template": "Remove guest user object permissions and method access"
      }
    },
    {
      "control_id": "SBS-DATA-001",
      "category": "Data Security",
      "category_description": "This section defines controls related to the protection, classification, and management of data stored within Salesforce environments. These controls ensure that organizations maintain visibility over sensitive data locations, implement appropriate safeguards for regulated information, and establish processes to support privacy compliance and breach response capabilities.",
      "title": "Implement Mechanisms to Detect Regulated Data in Long Text Area Fields",
      "statement": "The organization must implement a mechanism that continuously or periodically analyzes the contents of all Long Text Area fields to identify the presence of regulated or personal data.",
      "description": "Salesforce organizations must employ a technical or procedural mechanism to inspect the stored values of all Long Text Area (LTA) fields for regulated data, including PII, PHI, or GDPR-governed attributes. For example, a sales representative may enter customer phone numbers, email addresses, or even payment card details into an Opportunity \"Follow-Up Notes\" field, creating unstructured storage of regulated data that is difficult to detect without systematic scanning.",
      "risk": "Long Text Area fields often contain unstructured, user-entered information that may include sensitive personal data. Without a detection mechanism, regulated data accumulates in unknown locations\u2014obstructing compliance with GDPR Right to Erasure, CCPA deletion requests, and similar privacy obligations. During a security incident, the inability to identify which fields contain personal information makes it impossible to accurately assess exposure, determine the scope of compromised records, or fulfill breach notification requirements. This governance gap significantly impairs incident response and creates ongoing regulatory liability.",
      "risk_level": "High",
      "audit_procedure": "1. Identify all Long Text Area fields using Salesforce metadata.  \n\n2. Determine whether the organization has a mechanism that scans the *contents* of each LTA field for regulated data.  \n\n3. Confirm that scanning occurs continuously or on a defined recurring schedule.  \n\n4. Review scan logs, detection outputs, or configuration details to verify that the mechanism is operational.  \n\n5. Validate that all LTA fields across all objects are included in scope.  \n\n6. Determine compliance based on whether such a mechanism exists and is functioning.",
      "remediation": "1. Deploy or configure a tool, script, or process capable of analyzing the contents of LTA fields for regulated data.  \n\n2. Ensure scans run continuously or on a recurring schedule.  \n\n3. Confirm all applicable fields across all objects are included.  \n\n4. Document the scanning process and store execution evidence for audit support.",
      "default_value": "Salesforce does not natively scan the contents of Long Text Area fields for regulated data.",
      "remediation_scope": {
        "scope": "mechanism",
        "entity_type": ""
      },
      "task": {
        "title_template": "Implement regulated data detection for Long Text Area fields"
      }
    },
    {
      "control_id": "SBS-DATA-002",
      "category": "Data Security",
      "category_description": "This section defines controls related to the protection, classification, and management of data stored within Salesforce environments. These controls ensure that organizations maintain visibility over sensitive data locations, implement appropriate safeguards for regulated information, and establish processes to support privacy compliance and breach response capabilities.",
      "title": "Maintain an Inventory of Long Text Area Fields Containing Regulated Data",
      "statement": "The organization must maintain an up-to-date inventory of all Long Text Area fields that are known or detected to contain regulated or personal data.",
      "description": "Organizations must maintain a documented inventory listing each Long Text Area field that contains or is reasonably expected to contain regulated data, based on scanning outputs or operational use. For example, if a Case \"Internal Comments\" field routinely includes client account numbers or health-related information entered by support agents, that field must appear in the inventory and be tracked accordingly.",
      "risk": "Without a current inventory of fields containing regulated data, organizations cannot systematically apply appropriate protection, retention, or access controls to sensitive data locations\u2014and may be unable to fulfill privacy obligations such as GDPR's Right to Erasure or CCPA deletion requests that require knowing all locations where personal data is stored. During audits or breach investigations, the absence of a maintained inventory delays response times and may result in incomplete remediation or missed data locations.",
      "risk_level": "Moderate",
      "audit_procedure": "1. Obtain the organization's documented inventory of Long Text Area fields containing regulated data.  \n\n2. Compare the inventory against Salesforce metadata to confirm all relevant fields are included.  \n\n3. Review scan results or administrative evidence demonstrating how fields were identified.  \n\n4. Verify that the inventory includes object name, field API name, data classification, and last review date.  \n\n5. Determine whether the inventory is maintained and current; missing, outdated, or incomplete inventories indicate noncompliance.",
      "remediation": "1. Generate an inventory using scan results, administrative review, and metadata analysis.  \n\n2. Document all LTA fields containing regulated data and classify the associated data types.  \n\n3. Establish a recurring review cycle to update the inventory.  \n\n4. Integrate the inventory into governance functions such as retention, DLP, access reviews, and breach response planning.",
      "default_value": "Salesforce does not maintain or provide an inventory of Long Text Area fields containing regulated data.",
      "remediation_scope": {
        "scope": "inventory",
        "entity_type": ""
      },
      "task": {
        "title_template": "Establish and maintain Long Text Area field inventory"
      }
    },
    {
      "control_id": "SBS-DATA-003",
      "category": "Data Security",
      "category_description": "This section defines controls related to the protection, classification, and management of data stored within Salesforce environments. These controls ensure that organizations maintain visibility over sensitive data locations, implement appropriate safeguards for regulated information, and establish processes to support privacy compliance and breach response capabilities.",
      "title": "Maintain Tested Backup and Recovery for Salesforce Data and Metadata",
      "statement": "Salesforce production orgs must maintain a documented backup and recovery capability for Salesforce data and metadata, and must test restoration on a defined schedule.",
      "description": "Organizations must back up Salesforce data and metadata using Salesforce exports, APIs, source control, or third-party tooling, and must document recovery procedures sufficient to restore a known-good state.",
      "risk": "Without reliable backups and tested restoration procedures, organizations cannot recover from accidental deletion, malicious data destruction, configuration corruption, or ransomware-like events. This impairs incident response, business continuity, and the ability to validate data integrity after security events or outages.",
      "risk_level": "High",
      "audit_procedure": "1. Obtain the documented backup and recovery policy covering Salesforce data and metadata.  \n\n2. Verify that backups are performed on a defined schedule and retained per policy.  \n\n3. Review evidence of a completed restoration test within the defined testing interval.  \n\n4. Confirm that backup storage is protected with appropriate access controls.",
      "remediation": "1. Implement or configure a backup solution for Salesforce data and metadata.  \n\n2. Define backup frequency, retention, and storage protections.  \n\n3. Execute and document restoration tests on the defined schedule.  \n\n4. Update recovery procedures based on test results.",
      "default_value": "Salesforce does not provide automatic, comprehensive backup and restore for all data and metadata by default.",
      "remediation_scope": {
        "scope": "mechanism",
        "entity_type": ""
      },
      "task": {
        "title_template": "Implement and test Salesforce backup and recovery capability"
      }
    },
    {
      "control_id": "SBS-DATA-004",
      "category": "Data Security",
      "category_description": "This section defines controls related to the protection, classification, and management of data stored within Salesforce environments. These controls ensure that organizations maintain visibility over sensitive data locations, implement appropriate safeguards for regulated information, and establish processes to support privacy compliance and breach response capabilities.",
      "title": "Require Field History Tracking for Sensitive Fields",
      "statement": "The organization must maintain a documented list of sensitive fields and ensure Field History Tracking is enabled for each listed field on all in-scope objects.",
      "description": "Organizations must define which fields are sensitive (e.g., regulated data, financial identifiers, or security-relevant attributes) and enable Field History Tracking for those fields so changes can be audited. Any sensitive field without tracking is noncompliant.",
      "risk": "Without field history tracking on sensitive fields, unauthorized or accidental changes cannot be reliably detected or investigated. This reduces auditability, impairs incident response, and weakens accountability for changes to regulated or high-impact data.",
      "risk_level": "High",
      "audit_procedure": "1. Obtain the organization\u2019s documented list of sensitive fields and in-scope objects.  \n\n2. Enumerate Field History Tracking settings for those objects.  \n\n3. Verify that each listed sensitive field has Field History Tracking enabled.  \n\n4. Flag any sensitive field without tracking.",
      "remediation": "1. Enable Field History Tracking for all listed sensitive fields.  \n\n2. Update the sensitive-field list as schemas evolve.  \n\n3. Re-verify tracking coverage after changes.",
      "default_value": "Salesforce does not enable Field History Tracking for sensitive fields by default.",
      "remediation_scope": {
        "scope": "entity",
        "entity_type": "FieldDefinition"
      },
      "task": {
        "title_template": "Enable field history tracking for sensitive field: {{entity.name}}"
      }
    },
    {
      "control_id": "SBS-DEP-001",
      "category": "Deployments",
      "category_description": "This section defines controls related to metadata deployment practices, configuration change governance, and production environment integrity. These controls ensure that organizations establish clear provenance for production changes, restrict high-risk metadata modifications to controlled deployment processes, and maintain continuous monitoring to detect unauthorized configuration drift.",
      "title": "Require a Designated Deployment Identity for Metadata Changes",
      "statement": "Salesforce production orgs must designate a single deployment identity that is exclusively used for all metadata deployments and high-risk configuration changes performed through automated or scripted release processes.",
      "description": "A dedicated deployment identity (integration user) must be created and used as the sole account for CI/CD, metadata deployments, and automated release tooling. No human user\u2014regardless of administrative privilege\u2014may deploy metadata or execute automated deployment operations using their personal account.",
      "risk": "Without a designated deployment identity, organizations cannot reliably attribute production changes\u2014any administrator can deploy metadata, making it impossible to distinguish authorized CI/CD deployments from unauthorized manual changes. This loss of provenance prevents security teams from detecting unauthorized modifications, investigating configuration drift, or determining whether a change was part of an approved release. Attackers or malicious insiders can make direct production changes that blend into legitimate administrative activity, and incident responders cannot reconstruct the timeline of configuration changes during a breach investigation.",
      "risk_level": "High",
      "audit_procedure": "1. Identify the user account designated as the deployment identity.  \n\n2. Enumerate all recent metadata deployments using tooling such as Deployment Status, Metadata API logs, or audit logs.  \n\n3. Verify that all deployments were executed by the designated deployment identity.  \n\n4. Flag any metadata deployment performed by a human user or non-deployment identity.",
      "remediation": "1. Create or identify a dedicated deployment identity.  \n\n2. Reconfigure CI/CD pipelines, release management tooling, and automated deployment scripts to authenticate exclusively with the deployment identity.  \n\n3. Revoke deployment permissions from all human users.  \n\n4. Re-deploy any metadata last deployed by a human user to restore provenance.",
      "default_value": "Salesforce does not create or enforce a dedicated deployment identity by default.",
      "remediation_scope": {
        "scope": "org",
        "entity_type": ""
      },
      "task": {
        "title_template": "Designate and configure a single deployment identity for all metadata deployments"
      }
    },
    {
      "control_id": "SBS-DEP-002",
      "category": "Deployments",
      "category_description": "This section defines controls related to metadata deployment practices, configuration change governance, and production environment integrity. These controls ensure that organizations establish clear provenance for production changes, restrict high-risk metadata modifications to controlled deployment processes, and maintain continuous monitoring to detect unauthorized configuration drift.",
      "title": "Establish and Maintain a List of High-Risk Metadata Types Prohibited from Direct Production Editing",
      "statement": "Salesforce production orgs must maintain an explicit list of high-risk metadata types that must never be edited directly in production by human users, defaulting at minimum to the SBS baseline list while allowing organizations to extend or refine it as needed.",
      "description": "Organizations must adopt the SBS baseline list of prohibited direct-in-production changes\u2014which includes Apex Classes, Apex Triggers, LWCs, Aura Components, Profiles, Permission Set definitions, Remote Site Settings, Named Credentials, and core authentication or session security settings\u2014and maintain this list as an internal policy. Organizations may extend this list or define exceptions, but the minimum baseline must be included and documented.",
      "risk": "Without an explicit list of high-risk metadata types, organizations cannot define or enforce deployment governance boundaries\u2014leaving critical configuration categories (Apex code, authentication settings, outbound connectivity, permissions) open to uncontrolled direct production editing. Security teams cannot distinguish between metadata that requires strict deployment controls and metadata that can be safely edited manually, resulting in inconsistent governance and gaps in change attribution. The absence of a defined list also prevents effective monitoring (SBS-DEP-003), as there is no baseline to compare against when detecting unauthorized changes.",
      "risk_level": "High",
      "audit_procedure": "1. Obtain the organization's documented list of high-risk metadata types prohibited from direct production editing.  \n\n2. Confirm that the list, at minimum, includes all SBS baseline categories.  \n\n3. Review the list for any documented exceptions and verify they are formally approved.  \n\n4. Verify that only the deployment identity has modify permissions for metadata types on the list.",
      "remediation": "1. Adopt the SBS baseline list of prohibited direct-in-production metadata changes.  \n\n2. Add any organization-specific items or exceptions as needed.  \n\n3. Remove modify permissions for these metadata types from all human users.  \n\n4. Ensure all future changes to listed metadata types are performed exclusively by the deployment identity.",
      "default_value": "Salesforce does not provide native restrictions or guidance preventing direct production edits to high-risk metadata.",
      "remediation_scope": {
        "scope": "inventory",
        "entity_type": ""
      },
      "task": {
        "title_template": "Establish and maintain list of high-risk metadata types prohibited from direct production editing"
      }
    },
    {
      "control_id": "SBS-DEP-003",
      "category": "Deployments",
      "category_description": "This section defines controls related to metadata deployment practices, configuration change governance, and production environment integrity. These controls ensure that organizations establish clear provenance for production changes, restrict high-risk metadata modifications to controlled deployment processes, and maintain continuous monitoring to detect unauthorized configuration drift.",
      "title": "Monitor and Alert on Unauthorized Modifications to High-Risk Metadata",
      "statement": "Salesforce production orgs must implement a monitoring capability that detects and reports any modification to high-risk metadata performed by a user other than the designated deployment identity.",
      "description": "Organizations must maintain a monitoring process\u2014manual or automated\u2014that reviews administrative and metadata changes and identifies when high-risk metadata (as defined in SBS-DEP-002 or extended by the organization) is modified by a human user instead of the designated deployment identity. The monitoring method may use Salesforce APIs, audit logs, export files, CLI tooling, vendor tools, or any combination, provided it reliably detects unauthorized changes within the organization\u2019s defined review interval.",
      "risk": "Without monitoring for unauthorized metadata changes, organizations cannot detect when high-risk configuration is modified outside the approved deployment process\u2014allowing malicious changes, accidental drift, or insider threats to persist undetected. Security teams lose the ability to identify unauthorized modifications to authentication settings, permission structures, Apex code, or outbound connectivity until a breach or incident reveals the gap. This impairs detection, investigation, and response capabilities for configuration-related security events, extending attacker dwell time and preventing timely remediation of unauthorized changes.",
      "risk_level": "High",
      "audit_procedure": "1. Interview system owners to identify the monitoring method(s) used for detecting changes to high-risk metadata.  \n\n2. Review documentation describing how the monitoring process works\u2014whether manual log review, automated scripts, API queries, CLI workflows, scheduled exports, or vendor tools.  \n\n3. Verify that the monitoring process includes:  \n\n   - Coverage of all high-risk metadata types defined by the organization and required by SBS-DEP-002.  \n\n   - A review interval appropriate to the organization's change-management expectations (e.g., daily, weekly, or aligned with release cycles).  \n\n   - A method for identifying the user who performed each change.  \n\n4. Examine historical monitoring records or logs to confirm the process has been performed consistently.  \n\n5. Flag noncompliance if no monitoring system exists or if the system cannot detect unauthorized human modifications to high-risk metadata.",
      "remediation": "1. Implement a monitoring mechanism capable of identifying modifications to high-risk metadata and attributing them to the responsible user. Acceptable approaches include:  \n\n   - Manual periodic review of the Salesforce Setup Audit Trail,  \n\n   - Exporting audit logs for review,  \n\n   - Scheduled API or CLI queries comparing metadata changes,  \n\n   - Custom scripts,  \n\n   - Vendor-based monitoring tools.  \n\n2. Ensure the monitoring method covers all high-risk metadata types listed in the organization\u2019s defined prohibited-direct-edit list.  \n\n3. Define a repeatable review interval and assign responsibility for conducting the review.  \n\n4. Document the monitoring approach and maintain records of reviews and findings.",
      "default_value": "Salesforce does not provide built-in monitoring or alerting for unauthorized direct-in-production metadata changes; organizations must implement their own processes.",
      "remediation_scope": {
        "scope": "mechanism",
        "entity_type": ""
      },
      "task": {
        "title_template": "Implement monitoring capability to detect unauthorized modifications to high-risk metadata"
      }
    },
    {
      "control_id": "SBS-DEP-005",
      "category": "Deployments",
      "category_description": "This section defines controls related to metadata deployment practices, configuration change governance, and production environment integrity. These controls ensure that organizations establish clear provenance for production changes, restrict high-risk metadata modifications to controlled deployment processes, and maintain continuous monitoring to detect unauthorized configuration drift.",
      "title": "Implement Secret Scanning for Salesforce Source Repositories",
      "statement": "Organizations using source-driven development for Salesforce must implement automated secret scanning on all repositories containing Salesforce metadata, configuration, or deployment scripts to detect and prevent the exposure of credentials, access tokens, and other sensitive authentication material.",
      "description": "CI/CD pipelines for Salesforce deployments typically require long-lived access tokens, refresh tokens, or other credentials to authenticate as the designated deployment identity. If these credentials are hardcoded in scripts, configuration files, or committed to version control, they become accessible to anyone with repository access\u2014including contractors, consultants, former employees, or attackers who compromise the source control system. Organizations must implement automated secret scanning that runs on every commit and pull request to detect Salesforce-specific secrets (such as access tokens, refresh tokens, consumer secrets, and session IDs) as well as general credential patterns.",
      "risk": "Exposed Salesforce credentials in source repositories represent a direct path to unauthorized production access\u2014a supply chain attack vector that bypasses all other access controls. Contractors, consultants, or any party with repository access can extract hardcoded tokens and authenticate directly to production orgs with the full permissions of the deployment identity. Attackers who compromise source control systems or CI/CD infrastructure gain immediate access to production Salesforce environments. Unlike other credential exposures, Salesforce access tokens often have broad administrative permissions and long validity periods, making them high-value targets. Organizations cannot detect this exposure through Salesforce audit logs alone\u2014the attacker authenticates with valid credentials, and their activity appears legitimate.",
      "risk_level": "Critical",
      "audit_procedure": "1. Identify all repositories containing Salesforce metadata, SFDX projects, deployment scripts, or CI/CD pipeline configurations.  \n\n2. Verify that automated secret scanning is enabled on each repository\u2014either through the source control platform's native capabilities (e.g., GitHub Secret Scanning, GitLab Secret Detection) or through third-party tooling.  \n\n3. Confirm that the scanning configuration includes patterns for Salesforce-specific secrets (access tokens, refresh tokens, consumer keys/secrets, session IDs).  \n\n4. Review scanning logs or dashboards to verify the tool is actively running and producing results.  \n\n5. Verify that detected secrets trigger alerts and block merges or deployments until remediated.  \n\n6. Flag noncompliance if any Salesforce-related repository lacks active secret scanning coverage.",
      "remediation": "1. Enable secret scanning on all repositories containing Salesforce code, metadata, or deployment configurations using platform-native tools or third-party secret scanning solutions.  \n\n2. Configure scanning rules to detect Salesforce-specific credential patterns in addition to general secrets.  \n\n3. Implement pre-commit hooks or CI checks that block commits containing detected secrets.  \n\n4. Immediately rotate any Salesforce access tokens, refresh tokens, or credentials that have been committed to version control\u2014even if subsequently removed, as they persist in git history.  \n\n5. Migrate credential storage to secure secrets management solutions (e.g., CI/CD platform secrets, vault systems) and remove all hardcoded credentials from repositories.  \n\n6. Establish a periodic rotation schedule for Salesforce deployment credentials to limit the window of exposure if a secret is leaked.",
      "default_value": "Salesforce does not provide secret scanning capabilities; organizations must implement scanning through their source control platform or third-party tooling. Credentials can be freely committed to repositories without any native detection or prevention.",
      "remediation_scope": {
        "scope": "mechanism",
        "entity_type": ""
      },
      "task": {
        "title_template": "Implement secret scanning for Salesforce source repositories"
      }
    },
    {
      "control_id": "SBS-DEP-006",
      "category": "Deployments",
      "category_description": "This section defines controls related to metadata deployment practices, configuration change governance, and production environment integrity. These controls ensure that organizations establish clear provenance for production changes, restrict high-risk metadata modifications to controlled deployment processes, and maintain continuous monitoring to detect unauthorized configuration drift.",
      "title": "Configure Salesforce CLI Connected App with Token Expiration Policies",
      "statement": "Organizations must configure the Connected App used for Salesforce CLI authentication with refresh token expiration of 90 days or less and access token timeout of 15 minutes or less.",
      "description": "Salesforce CLI stores OAuth tokens locally on developer workstations to enable command-line access to orgs. The default \"Salesforce CLI\" Connected App ships with refresh tokens and access tokens set to never expire, meaning stolen or leaked token files provide indefinite access to authorized orgs. Organizations must either create a dedicated Connected App for CLI usage or install and configure the default Connected App with appropriate token expiration policies\u2014refresh tokens must expire within 90 days and access tokens must timeout within 15 minutes. When using a dedicated Connected App, organizations should use the `--client-id` flag with CLI authentication commands.",
      "risk": "Salesforce CLI token files stored on local workstations represent a persistent credential exposure risk. If a laptop is stolen, reassigned without proper cleanup, or compromised by malware, attackers can extract token files that provide direct access to Salesforce orgs\u2014including production environments. With the default Connected App configuration, these tokens never expire, giving attackers indefinite access that persists even after the original user's password is changed or their account is deactivated. The attack surface expands with each org a developer authenticates to, as token files accumulate credentials to sandboxes, Dev Hubs, and production orgs. Organizations cannot detect this credential theft through Salesforce audit logs because the attacker authenticates with valid tokens.",
      "risk_level": "High",
      "audit_procedure": "1. From Setup, navigate to Connected Apps OAuth Usage (or Apps \u2192 Connected Apps \u2192 Connected Apps OAuth Usage).  \n\n2. Identify the Connected App(s) used for Salesforce CLI authentication\u2014either the default \"Salesforce CLI\" app or a custom Connected App.  \n\n3. Review the OAuth Policies for each CLI-related Connected App:  \n\n   - Verify that Refresh Token Policy is set to \"Expire refresh token after\" with a value of 90 days or less.  \n\n   - Verify that Session Policies Timeout Value is set to 15 minutes or less.  \n\n4. If a custom Connected App is used, verify that developers are instructed to use the `--client-id` flag when authenticating.  \n\n5. Flag noncompliance if any CLI-related Connected App has tokens set to never expire or exceeds the maximum allowed durations.",
      "remediation": "1. Determine whether to use the default \"Salesforce CLI\" Connected App or create a dedicated Connected App for CLI authentication.  \n\n2. If using the default app:  \n\n   - From Setup, navigate to Connected Apps OAuth Usage.  \n\n   - Locate \"Salesforce CLI\" and click Install (if not already installed), then Edit Policies.  \n\n   - Set Refresh Token Policy to \"Expire refresh token after: 90 Days\" (or less).  \n\n   - Set Session Policies Timeout Value to \"15 minutes\" (or less).  \n\n3. If creating a dedicated Connected App:  \n\n   - Create a new Connected App with OAuth enabled and appropriate callback URL.  \n\n   - Configure refresh token expiry to 90 days or less and access token timeout to 15 minutes or less.  \n\n   - Distribute the Consumer Key to developers and require use of `--client-id` flag.  \n\n4. Communicate to developers that they will need to re-authenticate periodically when refresh tokens expire.  \n\n5. Consider implementing compensating controls to protect locally stored token files, such as:  \n\n   - Requiring full disk encryption (FileVault, BitLocker) on developer workstations.  \n\n   - Enabling remote wipe capability for managed devices.  \n\n   - Including Salesforce CLI token file cleanup in device offboarding procedures.  \n\n   - Training developers to run `sf org logout --all` before returning or transferring devices.",
      "default_value": "The default \"Salesforce CLI\" Connected App is configured with refresh tokens and access tokens that never expire. Organizations must explicitly install and configure the app or create a dedicated Connected App to enforce token expiration policies.",
      "remediation_scope": {
        "scope": "org",
        "entity_type": ""
      },
      "task": {
        "title_template": "Configure Salesforce CLI Connected App with token expiration policies"
      }
    },
    {
      "control_id": "SBS-FILE-001",
      "category": "File Security",
      "category_description": "This section defines controls related to file and content security in Salesforce environments. These controls ensure that organizations maintain appropriate protections, governance, and lifecycle management over files, documents, and content shared within or outside the organization\u2014reducing the risk of unauthorized access, data leakage, and exposure of sensitive information.",
      "title": "Require Expiry Dates on Public Content Links",
      "statement": "Organizations must ensure that Public Content links have an appropriate expiry date.",
      "description": "The organization must ensure that any content shared via Public Content links has an appropriate expiry date set dependent upon the classification of the content. The expiry date could be never for non-sensitive content\u2014a PDF of the organization's Privacy Policy as an example\u2014or it could be less than a week for sensitive information.",
      "risk": "Without an expiry date, Public Content links remain permanently accessible, extending the window of potential exposure indefinitely. While the link itself must be obtained by an unauthorized party for access to occur, perpetually valid links increase the cumulative risk of data exposure through link leakage, sharing, or discovery. Time-bounded links reduce the blast radius of any single link compromise and support data lifecycle governance.",
      "risk_level": "",
      "audit_procedure": "1. Enumerate all `ContentDistribution` object records via the SOAP/REST API or Apex.\n\n2. Identify all records where `PreferencesExpires = false`.\n\n3. Flag any Public Content links without expiry dates for review.",
      "remediation": "1. For each flagged content distribution record, determine the sensitivity classification of the associated content.\n\n2. Set an appropriate expiry date on the `ContentDistribution` object based on content classification.\n\n3. Establish organizational policy defining maximum link lifetimes by data classification.",
      "default_value": "When a user manually creates a Public Content link on a piece of content, Salesforce suggests an expiry date. This can be overridden by the user. In the past, the default was no expiry date.",
      "remediation_scope": {
        "scope": "",
        "entity_type": ""
      },
      "task": {
        "title_template": ""
      }
    },
    {
      "control_id": "SBS-FILE-002",
      "category": "File Security",
      "category_description": "This section defines controls related to file and content security in Salesforce environments. These controls ensure that organizations maintain appropriate protections, governance, and lifecycle management over files, documents, and content shared within or outside the organization\u2014reducing the risk of unauthorized access, data leakage, and exposure of sensitive information.",
      "title": "Require Passwords on Public Content Links for Sensitive Content",
      "statement": "Organizations must ensure that Public Content links to sensitive content have a password.",
      "description": "The organization must ensure that any sensitive content shared via Public Content links has a password set to protect the content if the link is intercepted or inadvertently shared.",
      "risk": "Without a password, anyone who obtains an unexpired Public Content link\u2014through interception, accidental sharing, or link harvesting\u2014can immediately access the associated data. For sensitive content, this creates a direct path to data exposure that requires only link acquisition. Password protection adds an authentication layer that prevents opportunistic access and limits the impact of link compromise, supporting breach containment and regulatory compliance for sensitive data handling.",
      "risk_level": "",
      "audit_procedure": "1. Enumerate all `ContentDistribution` object records via the SOAP/REST API or Apex.\n\n2. Identify all records where `Password` is null.\n\n3. Cross-reference with content classification to identify sensitive content lacking password protection.\n\n4. Flag any Public Content links to sensitive content without passwords for review.",
      "remediation": "1. For each flagged content distribution record, determine the sensitivity classification of the associated content.\n\n2. For sensitive content, set a password on the ContentDistribution record via the Salesforce UI.\n\n3. Communicate the password to intended recipients through a separate, secure channel.\n\n4. Establish organizational policy requiring password protection for all Public Content links to sensitive data.",
      "default_value": "When a user manually creates a Public Content link on a piece of content, the default is to not have a password.",
      "remediation_scope": {
        "scope": "",
        "entity_type": ""
      },
      "task": {
        "title_template": ""
      }
    },
    {
      "control_id": "SBS-FILE-003",
      "category": "File Security",
      "category_description": "This section defines controls related to file and content security in Salesforce environments. These controls ensure that organizations maintain appropriate protections, governance, and lifecycle management over files, documents, and content shared within or outside the organization\u2014reducing the risk of unauthorized access, data leakage, and exposure of sensitive information.",
      "title": "Periodic Review and Cleanup of Public Content Links",
      "statement": "Organizations must implement a recurring process to review all active Public Content links and remove or remediate links that are no longer required, lack appropriate controls, or were created outside of current policy.",
      "description": "The organization must establish a defined cadence (e.g., quarterly) to scan all `ContentDistribution` records and review active Public Content links. This review should identify links that are forgotten, no longer needed, were created before current security controls were implemented, resulted from accidental sharing, or otherwise do not comply with organizational policy. Identified links must be remediated by applying appropriate controls (expiry dates, passwords) or deleted if no longer required.",
      "risk": "Without periodic review, Public Content links accumulate over time\u2014including legacy links created before security policies were established, links that have outlived their business purpose, and links created through accidental or unauthorized sharing. These forgotten links represent persistent exposure that may go undetected indefinitely. While this control does not prevent initial link creation issues, it provides a governance mechanism to identify and remediate accumulated risk, supporting defense-in-depth and reducing the organization's overall exposure footprint.",
      "risk_level": "",
      "audit_procedure": "1. Verify the organization has a documented process for periodic Public Content link review.\n\n2. Confirm the review cadence is defined (e.g., quarterly, monthly) and appropriate for the organization's risk profile.\n\n3. Obtain evidence of recent review execution (e.g., scan results, remediation records, review meeting notes).\n\n4. Verify that reviews include all active `ContentDistribution` records.\n\n5. Confirm that identified issues are tracked through remediation or deletion.\n\n6. Flag organizations without a documented review process or evidence of recent execution.",
      "remediation": "1. Establish a documented process for periodic review of all `ContentDistribution` records.\n\n2. Define a review cadence appropriate to organizational risk tolerance (quarterly recommended as a baseline).\n\n3. Create a scanning mechanism (script, report, or tool) to enumerate all active Public Content links.\n\n4. Define review criteria to identify links requiring remediation: missing expiry dates, missing passwords on sensitive content, links older than a defined threshold, or links to content no longer requiring external sharing.\n\n5. Assign ownership for the review process and remediation actions.\n\n6. Maintain records of each review cycle for audit purposes.",
      "default_value": "Salesforce does not provide a built-in mechanism for periodic review of Public Content links; organizations must implement this process manually or through custom tooling.",
      "remediation_scope": {
        "scope": "",
        "entity_type": ""
      },
      "task": {
        "title_template": ""
      }
    },
    {
      "control_id": "SBS-FDNS-001",
      "category": "Foundations",
      "category_description": "This section establishes the foundational requirements for SBS compliance. These controls define the organizational capabilities and documentation practices that enable all other controls in the benchmark. Without a centralized system of record, organizations cannot reliably demonstrate compliance, maintain audit trails, or govern exceptions consistently across their Salesforce security posture.",
      "title": "Centralized Security System of Record",
      "statement": "The organization must maintain a centralized system of record documenting all Salesforce security configurations, exceptions, justifications, and SBS-required inventories.",
      "description": "The organization must maintain a centralized, durable, and accessible system of record that documents all Salesforce security-relevant configurations, exceptions, justifications, approvals, and control-specific inventories required by the SBS. The system of record must not rely on personal knowledge or undocumented institutional memory.",
      "risk": "A formally maintained system of record is foundational for ensuring repeatable, auditable, and transparent security governance. Without a centralized repository, organizations cannot reliably track required justifications, exceptions, or configuration states, resulting in control failures, loss of historical context, and inconsistent application of security standards. A system of record enables auditors, security engineers, and automation tools to validate compliance objectively.",
      "risk_level": "",
      "audit_procedure": "1. Identify and review the organization\u2019s designated system of record for Salesforce security governance.  \n\n2. Verify that the system of record is centrally accessible to authorized personnel and is not dependent on individual personnel knowledge.  \n\n3. Confirm that the system of record includes all artifacts required by SBS controls, including:  \n\n   - Documented justifications for elevated permissions or exceptions.  \n\n   - Inventories of profiles, permission sets, permission set groups, integrations, API-enabled entities, and other required listings.  \n\n   - Recorded security decisions, approvals, and exceptions.  \n\n4. Validate that the system of record is current and reflects the state of the Salesforce environment at the time of audit.",
      "remediation": "1. Establish or designate a centralized system of record capable of storing and maintaining all required SBS documentation.  \n\n2. Populate the system of record with all missing inventories, justifications, and security-relevant artifacts mandated by SBS controls.  \n\n3. Implement a maintenance process to keep the system of record current with ongoing changes to the Salesforce environment.",
      "default_value": "Salesforce does not provide or require a system of record for documenting security-relevant metadata, exceptions, or justifications.",
      "remediation_scope": {
        "scope": "",
        "entity_type": ""
      },
      "task": {
        "title_template": ""
      }
    },
    {
      "control_id": "SBS-INT-001",
      "category": "Integrations",
      "category_description": "This section defines controls related to outbound connectivity from Salesforce to external systems, including Remote Site Settings and Named Credentials. These controls ensure that organizations maintain visibility and governance over approved external endpoints, authentication mechanisms, and data flows initiated by Salesforce, reducing the risk of unauthorized data transmission, dependency on untrusted services, and configuration drift in integration pathways.",
      "title": "Enforce Governance of Browser Extensions Accessing Salesforce",
      "statement": "Organizations must enforce a centrally managed mechanism that restricts which browser extensions are permitted to access Salesforce, and must not allow the use of unmanaged or uncontrolled extensions.",
      "description": "Organizations must deploy a centrally managed governance mechanism\u2014such as Chrome Browser Cloud Management, MDM policies, or configuration profiles\u2014that enforces an allow-list or blocklist for browser extensions accessing Salesforce domains.",
      "risk": "Without centralized governance over browser extensions, malicious or cloned extensions\u2014increasingly common with AI-generated code\u2014can harvest session tokens, exfiltrate data, and execute unauthorized operations within authenticated Salesforce sessions. However, this control provides governance and defense-in-depth rather than establishing a Salesforce-native security boundary: exploitation requires a malicious extension to be installed and an authenticated session to exist. Other controls (SSO, session management) still provide protection, and this governance mechanism operates outside Salesforce via MDM or browser management.",
      "risk_level": "Moderate",
      "audit_procedure": "1. Request evidence of a browser-extension governance mechanism applied to user devices (e.g., Chrome Browser Cloud Management, Intune configuration profile, Jamf configuration profile, Active Directory GPO, or equivalent).\n\n2. Require a screenshot, exported policy file, or screen capture demonstrating that extension controls are active and enforceable (e.g., an allow-list or blocklist configuration for Chrome extensions).\n\n3. Verify that the mechanism explicitly restricts installation or execution of unapproved extensions that can access Salesforce domains.\n\n4. Flag the organization as noncompliant if no enforceable governance mechanism exists or if extension governance is based solely on policy, awareness, or voluntary user behavior.\n\n5. Download API Total Usage logs (EventLogFile - ApiTotalUsage, available in free tier of Event Monitoring) and analyze for indicators of unauthorized browser extension activity:\n\n   - Review `USER_AGENT` field for patterns indicating browser extensions (e.g., extension identifiers, non-standard user agents).\n\n   - Identify API call patterns characteristic of auto-refresh extensions (e.g., Inspector Reloader) such as regular-interval repeated requests.\n\n   - Flag any anomalous patterns for investigation against approved extension inventory.",
      "remediation": "1. Implement a centrally managed browser or device management solution capable of enforcing extension restrictions (e.g., Chrome Browser Cloud Management, Intune, Jamf, or GPO-based controls).  \n\n2. Define and apply an allow-list or blocklist policy governing which extensions are permitted to interact with Salesforce.  \n\n3. Remove or disable any unapproved browser extensions from managed devices.  \n\n4. Apply enforcement policies to all corporate-managed devices accessing Salesforce.",
      "default_value": "Salesforce provides no mechanism to prevent or detect browser extension usage; unmanaged browser extensions are permitted by default, including those capable of accessing Salesforce data and authenticated sessions.",
      "remediation_scope": {
        "scope": "mechanism",
        "entity_type": ""
      },
      "task": {
        "title_template": "Implement centralized browser extension governance"
      }
    },
    {
      "control_id": "SBS-INT-002",
      "category": "Integrations",
      "category_description": "This section defines controls related to outbound connectivity from Salesforce to external systems, including Remote Site Settings and Named Credentials. These controls ensure that organizations maintain visibility and governance over approved external endpoints, authentication mechanisms, and data flows initiated by Salesforce, reducing the risk of unauthorized data transmission, dependency on untrusted services, and configuration drift in integration pathways.",
      "title": "Inventory and Justification of Remote Site Settings",
      "statement": "Organizations must maintain an authoritative inventory of all Remote Site Settings and document a business justification for each endpoint approved for Apex HTTP callouts.",
      "description": "All Remote Site Settings configured in Salesforce must be recorded in the organization\u2019s system of record along with a clear business justification demonstrating why the endpoint is required and trusted for use in Apex HTTP callouts.",
      "risk": "Without a documented inventory and justification for Remote Site Settings, unvetted or insecure endpoints may be authorized for Apex HTTP callouts\u2014exposing the organization to data leakage, dependency risks, or communication with untrusted services. However, this control provides governance documentation rather than detection or prevention capability: it supports audit readiness and informed decision-making, but other controls are required to detect or prevent actual data exfiltration through approved endpoints.",
      "risk_level": "Moderate",
      "audit_procedure": "1. Enumerate all Remote Site Settings via Salesforce Setup or the Metadata API.  \n\n2. Retrieve the organization\u2019s system of record for approved outbound endpoints.  \n\n3. Compare the Salesforce list to the system of record to confirm each Remote Site Setting is documented.  \n\n4. Verify that each documented Remote Site Setting includes a clear business justification.  \n\n5. Flag any Remote Site Settings missing from the inventory or lacking justification as noncompliant.",
      "remediation": "1. Add all undocumented Remote Site Settings to the system of record.  \n\n2. Document a valid business justification for each endpoint.  \n\n3. Remove or disable any Remote Site Settings that cannot be justified.  \n\n4. Implement a recurring process to reconcile Remote Site Settings with the system of record.",
      "default_value": "Salesforce does not require or maintain business justification for Remote Site Settings and does not enforce an external inventory.",
      "remediation_scope": {
        "scope": "entity",
        "entity_type": "RemoteSiteSetting"
      },
      "task": {
        "title_template": "Review and justify Remote Site Setting: {{entity.name}}"
      }
    },
    {
      "control_id": "SBS-INT-003",
      "category": "Integrations",
      "category_description": "This section defines controls related to outbound connectivity from Salesforce to external systems, including Remote Site Settings and Named Credentials. These controls ensure that organizations maintain visibility and governance over approved external endpoints, authentication mechanisms, and data flows initiated by Salesforce, reducing the risk of unauthorized data transmission, dependency on untrusted services, and configuration drift in integration pathways.",
      "title": "Inventory and Justification of Named Credentials",
      "statement": "Organizations must maintain an authoritative inventory of all Named Credentials and document a business justification for each external endpoint and authentication configuration approved for use in Salesforce.",
      "description": "All Named Credentials defined in Salesforce\u2014regardless of authentication type or use case\u2014must be recorded in the organization\u2019s system of record, including the endpoint URL, authentication model, and a clear business justification demonstrating why the connection is required and trusted for Apex callouts, External Services, or external data access.",
      "risk": "Without a documented inventory and justification for Named Credentials, undocumented or unjustified configurations may expose the organization to data leakage, unauthorized integrations, or reliance on insecure or untrusted endpoints. However, this control provides governance documentation rather than detection or prevention capability: it supports audit readiness and informed decision-making about authenticated external connections, but other controls are required to detect or prevent actual misuse of approved credentials.",
      "risk_level": "Moderate",
      "audit_procedure": "1. Enumerate all Named Credentials using Salesforce Setup, Metadata API, Tooling API, or Connect REST API.  \n\n2. Retrieve the organization\u2019s system of record for approved external endpoints and integration credentials.  \n\n3. Compare the Salesforce list to the system of record to confirm all Named Credentials are documented.  \n\n4. Verify that each documented Named Credential includes:  \n\n   - The external endpoint URL  \n\n   - The authentication type (named principal or per-user)  \n\n   - The business justification for the integration  \n\n5. Flag any Named Credentials missing from the inventory or lacking justification as noncompliant.",
      "remediation": "1. Add any undocumented Named Credentials to the system of record.  \n\n2. Document a valid business justification for each Named Credential.  \n\n3. Remove, disable, or reconfigure any Named Credentials that cannot be justified or that reference untrusted endpoints.  \n\n4. Establish a recurring reconciliation process to ensure Named Credentials remain fully inventoried and justified.",
      "default_value": "Salesforce does not maintain or enforce an external inventory or business justification for Named Credentials.",
      "remediation_scope": {
        "scope": "entity",
        "entity_type": "NamedCredential"
      },
      "task": {
        "title_template": "Review and justify Named Credential: {{entity.name}}"
      }
    },
    {
      "control_id": "SBS-INT-004",
      "category": "Integrations",
      "category_description": "This section defines controls related to outbound connectivity from Salesforce to external systems, including Remote Site Settings and Named Credentials. These controls ensure that organizations maintain visibility and governance over approved external endpoints, authentication mechanisms, and data flows initiated by Salesforce, reducing the risk of unauthorized data transmission, dependency on untrusted services, and configuration drift in integration pathways.",
      "title": "Retain API Total Usage Event Logs for 30 Days",
      "statement": "The organization must retain API Total Usage event log data (EventLogFile EventType=ApiTotalUsage) for at least the immediately preceding 30 days using Salesforce-native retention or automated external export and storage.\n\n**Description**:\n\nIf the organization\u2019s Salesforce does not provide at least 30 days of ApiTotalUsage EventLogFile availability in Salesforce, the organization must automatically export newly available ApiTotalUsage event log files at least once every 24 hours to an external log store that retains a minimum of 30 days of data.",
      "description": "",
      "risk": "Without retained API Total Usage logs, organizations lose visibility into REST, SOAP, and Bulk API activity\u2014including user identity, connected app, client IP, resource accessed, and status codes. This materially degrades the ability to detect anomalous API behavior, investigate security incidents, attribute unauthorized access, and determine the scope of potential breaches. The absence of this visibility creates a significant gap in incident detection and response capabilities. **Audit Procedure**: 1. Determine whether the organization relies on Salesforce-native retention (Event Monitoring/Shield/Event Monitoring add-on) or an external log store as the system of record for ApiTotalUsage EventLogFile data. 2. If the organization relies on Salesforce-native retention, verify that EventLogFile data is retained for at least 30 days (for example, confirm the org is entitled to and configured for Event Log File retention that is at least 30 days and can retrieve ApiTotalUsage EventLogFile data within the preceding 30-day window). 3. If the organization relies on an external log store (including all orgs with only 1-day ApiTotalUsage availability in Salesforce): - Verify an automated process exists that retrieves EventLogFile entries where EventType='ApiTotalUsage' and downloads the associated log files at least once every 24 hours. - Inspect job schedules/run history and confirm successful executions covering at least the last 30 days (no missed days). - From the external log store, retrieve ApiTotalUsage logs for (a) the oldest day in the preceding 30-day window and (b) the most recent day, and confirm both are accessible and attributable to the organization. - Verify access to the external log store is restricted to authorized roles and service identities responsible for monitoring and investigations. **Remediation**: 1. If the organization has only 1-day ApiTotalUsage EventLogFile availability in Salesforce, implement an automated daily export that downloads newly available ApiTotalUsage log files and stores them externally for at least 30 days. 2. If the organization uses Salesforce-native retention, ensure the configured retention period for Event Log Files is not less than 30 days. 3. Restrict access to the retained logs (Salesforce-native or external) to authorized personnel and designated service identities. **Default Value**: Enterprise, Unlimited, and Performance Edition organizations have free access to the ApiTotalUsage event type with 1-day data retention, while organizations with Shield/Event Monitoring add-on retain Event Log Files for 30 days by default (and may be eligible to extend retention).",
      "risk_level": "High",
      "audit_procedure": "",
      "remediation": "",
      "default_value": "",
      "remediation_scope": {
        "scope": "mechanism",
        "entity_type": ""
      },
      "task": {
        "title_template": "Implement 30-day API Total Usage log retention"
      }
    },
    {
      "control_id": "SBS-OAUTH-001",
      "category": "OAuth Security",
      "category_description": "This section defines controls related to OAuth-enabled Connected Apps, third-party integrations, and external access to Salesforce environments. These controls ensure that organizations maintain visibility, governance, and lifecycle management over external systems that authenticate to Salesforce via OAuth, reducing the risk of unauthorized access, data exfiltration, and stale integration pathways.",
      "title": "Require Formal Installation of Connected Apps",
      "statement": "Organizations must formally install all connected apps used for OAuth authentication rather than relying on user-authorized OAuth connections.",
      "description": "The organization must ensure that any connected app used for OAuth authentication is formally installed in the Salesforce org as a managed or unmanaged connected app rather than implicitly created through user-initiated OAuth flows. Connected apps that appear only as user-authorized OAuth connections without formal installation expose the org to unmanaged security settings and prevent centralized governance.",
      "risk": "Without formal installation, Connected Apps operate outside organizational control\u2014inheriting security configuration from the external app developer rather than the Salesforce administrator. This establishes an unmanaged security boundary: refresh token lifetimes, session policies, and IP restrictions cannot be enforced, allowing tokens to persist indefinitely and enabling unauthorized access from any location. Attackers who compromise a user-authorized OAuth token gain persistent access that administrators cannot revoke or constrain through standard Connected App policies.",
      "risk_level": "Critical",
      "audit_procedure": "1. Enumerate all user-authorized OAuth connected apps via Setup or the Tooling/Metadata API.  \n\n2. Identify all connected apps that are not formally installed as managed or unmanaged connected apps.  \n\n3. Flag any connected app that is used but not formally installed as noncompliant.",
      "remediation": "1. Formally install any connected app that appears only as a user-authorized OAuth connection.  \n\n2. Configure the installed connected app's policies, including refresh token and session security settings.  \n\n3. Remove the user-authorized OAuth connections that are now superseded by the installed connected app.",
      "default_value": "When a user first authenticates to a connected app via OAuth, Salesforce automatically creates a user-authorized OAuth entry that is not formally installed.",
      "remediation_scope": {
        "scope": "entity",
        "entity_type": "ConnectedApp"
      },
      "task": {
        "title_template": "Formally install Connected App: {{entity.name}}"
      }
    },
    {
      "control_id": "SBS-OAUTH-002",
      "category": "OAuth Security",
      "category_description": "This section defines controls related to OAuth-enabled Connected Apps, third-party integrations, and external access to Salesforce environments. These controls ensure that organizations maintain visibility, governance, and lifecycle management over external systems that authenticate to Salesforce via OAuth, reducing the risk of unauthorized access, data exfiltration, and stale integration pathways.",
      "title": "Require Profile or Permission Set Access Control for Connected Apps",
      "statement": "Organizations must control access to each formally installed connected app exclusively through assigned profiles or permission sets.",
      "description": "All formally installed connected apps must govern user access through explicit profile or permission set assignments. No connected app may rely on unrestricted or unmanaged access models.",
      "risk": "Without explicit profile or permission set access control, Connected Apps may allow any user in the org to authenticate\u2014bypassing the principle of least privilege and creating an uncontrolled access boundary. This enables unauthorized users to establish OAuth sessions with external systems, potentially exfiltrating data or performing actions beyond their intended scope. The lack of access scoping also eliminates audit visibility into who is authorized to use each integration, preventing detection of unauthorized access patterns.",
      "risk_level": "Critical",
      "audit_procedure": "1. Enumerate all formally installed connected apps via Setup or the Metadata API.  \n\n2. For each installed connected app, verify that access is granted only through assigned profiles or permission sets.  \n\n3. Flag any connected app that lacks access scoping via profiles or permission sets as noncompliant.",
      "remediation": "1. For each connected app lacking profile or permission set access control, create or update profiles or permission sets to define which users are authorized to access the app.  \n\n2. Assign the appropriate profiles or permission sets to the connected app configuration.  \n\n3. Verify that no users can access the connected app without explicit authorization.",
      "default_value": "Salesforce does not require profile or permission set access control for connected apps by default. Access models vary based on connected app configuration.",
      "remediation_scope": {
        "scope": "entity",
        "entity_type": "ConnectedApp"
      },
      "task": {
        "title_template": "Configure profile or permission set access for Connected App: {{entity.name}}"
      }
    },
    {
      "control_id": "SBS-OAUTH-003",
      "category": "OAuth Security",
      "category_description": "This section defines controls related to OAuth-enabled Connected Apps, third-party integrations, and external access to Salesforce environments. These controls ensure that organizations maintain visibility, governance, and lifecycle management over external systems that authenticate to Salesforce via OAuth, reducing the risk of unauthorized access, data exfiltration, and stale integration pathways.",
      "title": "Add Criticality Classification of OAuth-Enabled Connected Apps",
      "statement": "All OAuth-enabled Connected Apps must be recorded in an authoritative system of record and assigned a documented vendor criticality rating reflecting integration importance and data sensitivity.",
      "description": "Organizations must maintain a complete, authoritative inventory of all OAuth-enabled Connected Apps and assign each an explicit vendor criticality rating based on operational importance and the sensitivity of accessible Salesforce data.",
      "risk": "Without a complete inventory and criticality classification, organizations lose visibility into their third-party integration landscape\u2014preventing effective risk assessment, prioritization of security controls, and governance of external system connectivity. Security teams cannot identify which integrations access sensitive data, scope the impact of a vendor compromise, or respond effectively to incidents involving Connected Apps. This impairs detection, investigation, and response capabilities for integration-related security events.",
      "risk_level": "High",
      "audit_procedure": "1. Retrieve a list of all Connected Apps with active OAuth configurations from Salesforce Setup.  \n\n2. Retrieve the organization's authoritative system of record for integration and vendor management.  \n\n3. Compare the Salesforce Connected App list to the system of record and confirm every OAuth-enabled Connected App appears in the inventory.  \n\n4. Verify each listed Connected App has an assigned vendor criticality rating documented in the system of record.  \n\n5. Flag any apps missing from the inventory or lacking a documented criticality rating as noncompliant.",
      "remediation": "1. Add any missing OAuth-enabled Connected Apps to the system of record.  \n\n2. Document and assign a vendor criticality rating to each Connected App based on operational importance and data sensitivity.  \n\n3. Implement a recurring process to synchronize Connected App changes with the system of record.",
      "default_value": "Salesforce does not automatically maintain or enforce an external inventory or criticality classification for Connected Apps.",
      "remediation_scope": {
        "scope": "entity",
        "entity_type": "ConnectedApp"
      },
      "task": {
        "title_template": "Add criticality classification for Connected App: {{entity.name}}"
      }
    },
    {
      "control_id": "SBS-OAUTH-004",
      "category": "OAuth Security",
      "category_description": "This section defines controls related to OAuth-enabled Connected Apps, third-party integrations, and external access to Salesforce environments. These controls ensure that organizations maintain visibility, governance, and lifecycle management over external systems that authenticate to Salesforce via OAuth, reducing the risk of unauthorized access, data exfiltration, and stale integration pathways.",
      "title": "Due Diligence Documentation for High-Risk Connected App Vendors",
      "statement": "Organizations must review and retain available security documentation for all high-risk Connected App vendors and explicitly record any missing documentation as part of the vendor assessment.",
      "description": "For each Connected App vendor classified as high-risk, the organization must collect, review, and store relevant security documentation\u2014including terms of use, privacy policy, trust center or security overview, and any published information security guidelines\u2014and must explicitly document when a required artifact does not exist.",
      "risk": "Without documented due diligence for high-risk vendors, organizations may onboard integrations without understanding the vendor's security posture, data handling practices, or contractual obligations. This increases the likelihood of undiscovered risks but does not directly enable unauthorized access\u2014other controls (SBS-OAUTH-001, SBS-OAUTH-002) still govern the technical security boundary. Missing documentation primarily impacts audit readiness, risk assessment accuracy, and the organization's ability to make informed decisions about vendor relationships.",
      "risk_level": "Moderate",
      "audit_procedure": "1. Retrieve the list of Connected App vendors classified as high-risk from the organization\u2019s system of record.  \n\n2. For each high-risk vendor, verify that the following documents, where available, are stored in the designated repository:  \n\n   - Terms of use  \n\n   - Privacy policy  \n\n   - Trust center or security overview  \n\n   - Published information security guidelines  \n\n3. Confirm that any missing documentation is explicitly recorded as unavailable in the vendor assessment.  \n\n4. Flag any high-risk vendor lacking required documentation or missing explicit acknowledgment of unavailable documents as noncompliant.",
      "remediation": "1. Collect and store all required documentation for each high-risk vendor.  \n\n2. Where documentation does not exist, record this absence in the vendor assessment.  \n\n3. Update the vendor management process to ensure ongoing due diligence for high-risk vendors.",
      "default_value": "Salesforce does not manage or enforce vendor due diligence requirements for Connected App providers.",
      "remediation_scope": {
        "scope": "entity",
        "entity_type": "Vendor"
      },
      "task": {
        "title_template": "Collect security documentation for vendor: {{entity.name}}"
      }
    },
    {
      "control_id": "SBS-SECCONF-001",
      "category": "Security Configuration",
      "category_description": "This section defines controls related to Salesforce platform security settings and configuration management. These controls ensure that organizations establish clear security baselines, continuously monitor configuration drift, and maintain intentional security postures through systematic review and remediation of platform settings.",
      "title": "Establish a Salesforce Health Check Baseline",
      "statement": "Salesforce production orgs must define and maintain a Salesforce Health Check baseline\u2014including Salesforce's native baseline XML or an equivalent customized baseline\u2014and ensure it reflects the organization's intentional security configuration posture.",
      "description": "Organizations must create, upload, and maintain a Salesforce Health Check baseline template in XML format. The baseline must reflect the organization's required security configuration for key platform settings across authentication, session management, content security, and other Health Check parameters. Organizations may use Salesforce's default baseline, an SBS-recommended baseline, or a custom internal baseline, but the baseline must be explicitly defined, documented, and uploaded into Salesforce Health Check.",
      "risk": "Without a defined Health Check baseline, organizations have no authoritative reference for what their security configuration should be\u2014making it impossible to detect drift, evaluate deviations, or determine whether current settings reflect intentional decisions or accumulated neglect. Security teams cannot assess configuration-related risk, investigate whether settings were deliberately changed, or demonstrate compliance with security requirements. The absence of a baseline also prevents effective use of Health Check deviation monitoring (SBS-SECCONF-002), as there is no standard to measure against.",
      "risk_level": "High",
      "audit_procedure": "1. Navigate to **Setup \u2192 Health Check** and confirm that a baseline template is uploaded and active.  \n\n2. Review the XML baseline directly (via UI or API) to verify that the baseline exists and contains intentional values rather than defaults left unexamined.  \n\n3. Interview administrators to confirm the baseline was deliberately chosen or customized and is understood as the organization's configuration standard.  \n\n4. If the organization lacks a baseline, flag the control as noncompliant.",
      "remediation": "1. Create or select a Health Check baseline (Salesforce default, SBS-recommended baseline, or a custom-defined XML).  \n\n2. Upload the baseline XML into **Setup \u2192 Health Check**.  \n\n3. Document ownership of the baseline and establish a process for periodic review and updates.  \n\n4. Communicate the baseline's purpose and implications to system owners and security stakeholders.",
      "default_value": "Salesforce provides a default baseline but does not require organizations to review, customize, or maintain it.",
      "remediation_scope": {
        "scope": "org",
        "entity_type": ""
      },
      "task": {
        "title_template": "Define and upload a Salesforce Health Check baseline"
      }
    },
    {
      "control_id": "SBS-SECCONF-002",
      "category": "Security Configuration",
      "category_description": "This section defines controls related to Salesforce platform security settings and configuration management. These controls ensure that organizations establish clear security baselines, continuously monitor configuration drift, and maintain intentional security postures through systematic review and remediation of platform settings.",
      "title": "Review and Remediate Salesforce Health Check Deviations",
      "statement": "Salesforce production orgs must periodically review Health Check results against the defined baseline and remediate deviations or formally document approved exceptions.",
      "description": "Organizations must maintain a repeatable process for reviewing deviations identified in Salesforce Health Check. The process may be manual or automated, and may use Salesforce's native UI, exported Health Check data, API-driven reports, or third-party tooling. The organization must remediate deviations that represent unapproved risk or document and track exceptions when deviations are intentional or operationally necessary.",
      "risk": "Without periodic review and remediation of Health Check deviations, configuration drift accumulates undetected\u2014weakening security posture over time as settings diverge from the intended baseline. Security teams cannot identify when critical platform settings (authentication, session management, content security) have been changed or misconfigured, preventing timely response to emerging vulnerabilities. Unaddressed deviations may persist indefinitely, creating exploitable gaps that remain invisible until a breach or audit reveals the exposure.",
      "risk_level": "High",
      "audit_procedure": "1. Interview system owners to identify the established Health Check review process and review interval (e.g., monthly, quarterly).  \n\n2. Examine evidence of recent Health Check reviews, such as documented review artifacts, exported reports, tickets, changes, or exception records.  \n\n3. Verify that deviations were:  \n\n   - Remediated within the review window, **or**  \n\n   - Documented as exceptions with clear justification and approval.  \n\n4. Confirm that the review process is repeatable, assigned to an owner, and actually followed.  \n\n5. Flag noncompliance if:  \n\n   - No review process exists,  \n\n   - No review evidence can be produced, or  \n\n   - Deviations occur without remediation or exception documentation.",
      "remediation": "1. Establish a recurring review process using any reliable method, including:  \n\n   - Salesforce Health Check UI,  \n\n   - API exports,  \n\n   - CLI automation,  \n\n   - Scheduled scripts,  \n\n   - Vendor tooling.  \n\n2. Assign ownership for conducting the review and maintaining documentation.  \n\n3. Review current deviations and either remediate them or document exceptions.  \n\n4. Implement tracking to ensure deviations are remediated or re-reviewed in future cycles.",
      "default_value": "Salesforce does not require or track periodic Health Check reviews; deviations may persist indefinitely without administrative action.",
      "remediation_scope": {
        "scope": "mechanism",
        "entity_type": ""
      },
      "task": {
        "title_template": "Establish periodic Health Check review process with deviation remediation or exception tracking"
      }
    }
  ]
}